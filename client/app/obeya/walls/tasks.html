<!-- START 4- Tasks -->
<div id="Wall-3" class="wall_flex wall_flex_nowrap" ng-if="activeWall.id===5">

    <div class="obeya-pane obeya-pane-fixed-left obeya-pane-darkgray">
        Questions
        <hr style="margin-top:0;margin-bottom:10px;">
        <div class="obeya-body">
            <h4>
                <img src="assets/images/todo.png" style="width:60px;height:60px;" alt=""> Tasks
            </h4>
            <ul class="list-group card-list">
                <li class="list-group-item" ng-if="obeyaMode === 'week'" ng-class="{'list-group-item-active':filters === 'week'}">
                    <img src="assets/images/calendar-week.png" style="width:15px;height:15px;" alt=""> This Week
                    <span class="badge badge-gray">{{hierarchiesThisWeek.length}}</span>
                </li>
                <li class="list-group-item" ng-if="obeyaMode === 'month'" ng-class="{'list-group-item-active':filters === 'month'}">
                    <img src="assets/images/calendar-month.png" style="width:15px;height:15px;" alt=""> This Month
                    <span class="badge badge-gray">{{hierarchiesThisMonth.length}}</span>
                </li>
                <li class="list-group-item" ng-if="obeyaMode === 'all'" ng-click="showCard('Tasks','All')" ng-class="{'list-group-item-active':filters === 'All'}">
                    <img src="assets/images/calendar-month.png" style="width:15px;height:15px;" alt=""> All
                    <span class="badge badge-gray">{{hierarchiesSelected.length}}</span>
                </li>
                <li class="list-group-item" ng-click="showCard('Tasks','Incomplete')" ng-class="{'list-group-item-active':filters === 'Incomplete'}">
                    <i class="fa fa-gavel "></i> Incomplete
                    <span class="badge" ng-class="{'badge-gray':tasksIncomplete.length===0, 'badge-orange':tasksIncomplete.length>0}">{{tasksIncomplete.length}}</span>
                </li>
                <li class="list-group-item" ng-click="showCard('Tasks','WithAlerts')" ng-class="{'list-group-item-active':filters === 'WithAlerts'}">
                    <i class="fa fa-bell "></i> With alerts
                    <span class="badge " ng-class="{'badge-gray':tasksWithAlerts.length===0, 'badge-red':tasksWithAlerts.length>0}">{{tasksWithAlerts.length}}</span>
                </li>
            </ul>
            <br>

            <div ng-include src="'app/obeya/partials/viewMode.html'"></div>
        </div>
    </div>
    <div class="obeya-pane pane-grow  obeya-pane-darkgray">
        Tasks
        <hr style="margin-top:0;margin-bottom:10px;">
        <div class="obeya-body">


          <div id="dashboard_list" ng-if="viewMode.Tasks==='List'">
            <table class="table table-striped table-bordered table-hover" id="sample_4">
              <thead>
                <tr>
                  <th style="max-width:125px;width:125px;min-width:20px;">
                    <a style="text-decoration: none" href="#" ng-click="orderByField='actor'; reverseSort = !reverseSort">
                      <i class="fa fa-users"></i> From <span ng-show="orderByField === 'actor'"><span ng-show="!reverseSort"> &nbsp;&nbsp;&nbsp; <i class="fa fa-sort-asc"></i></span><span ng-show="reverseSort">&nbsp;&nbsp;&nbsp; <i class="fa fa-sort-desc"></i></span></span>
                    </a>
                  </th>
                  <th style="min-width:380px;max-width:750px;width:auto">
                    <a id="orderName" style="text-decoration: none" href="#" ng-click="orderByField='name'; reverseSort = !reverseSort">
                      <i class="fa fa-tasks"></i>  Name <span ng-show="orderByField === 'name'"><span ng-show="!reverseSort"> &nbsp;&nbsp;&nbsp; <i class="fa fa-sort-asc"></i></span><span ng-show="reverseSort">&nbsp;&nbsp;&nbsp; <i class="fa fa-sort-desc"></i></span></span>
                    </a>
                    <small  style="padding-left:30px">

                    <a href="#" ng-click="orderByField='activity'; reverseSort = !reverseSort" class="text-muted">
                      <i class="fa fa-flash"></i>   Process
                    </a>
                  </small>
                  <small class="text-muted pull-right"  id="step1" >

                    <!-- Split button -->
                  <div id="multipleActions" class="btn-group" uib-dropdown>
                    <button id="split-button" type="button" class="btn btn-danger">Multiple Action</button>
                    <button type="button" class="btn btn-danger" uib-dropdown-toggle>
                      <span class="caret"></span>
                      <span class="sr-only">Split button!</span>
                    </button>
                    <ul class="dropdown-menu" uib-dropdown-menu role="menu" aria-labelledby="split-button">
                      <li role="menuitem"><a href="#" ng-click="multiOpen()"><span class="text-primary">Open</span> selected tasks in differents tabs&nbsp;&nbsp;</a></li>
                      <li role="menuitem"><a href="#" ng-click="multiDelete()"><span class="text-danger">Delete</span>  forever selected tasks</a></li>
                    </ul>
                  </div>

                  </small>
                  </th>
                  <th style="max-width:225px;">
                    <a style="text-decoration: none" href="#" ng-click="orderByField='context'; reverseSort = !reverseSort">
                      <i class="fa fa-map-marker"></i>   Contexte <span ng-show="orderByField === 'context'"><span ng-show="!reverseSort"> &nbsp;&nbsp;&nbsp; <i class="fa fa-sort-asc"></i></span><span ng-show="reverseSort">&nbsp;&nbsp;&nbsp; <i class="fa fa-sort-desc"></i></span></span>
                    </a>
                  </th>
                  <th style="max-width:125px;width:125px;min-width:20px;">
                    <a style="text-decoration: none" href="#" ng-click="orderByField='startDate'; reverseSort = !reverseSort">
                      Start <span ng-show="orderByField === 'startDate'"><span ng-show="!reverseSort"> &nbsp;&nbsp;&nbsp; <i class="fa fa-sort-asc"></i></span><span ng-show="reverseSort">&nbsp;&nbsp;&nbsp; <i class="fa fa-sort-desc"></i></span></span>
                    </a>
                  </th>
                  <th style="max-width:125px;width:125px;min-width:50px;">
                    <a style="text-decoration: none" href="#" ng-click="orderByField='endDate'; reverseSort = !reverseSort">
                      End <span ng-show="orderByField === 'endDate'"><span ng-show="!reverseSort"> &nbsp;&nbsp;&nbsp; <i class="fa fa-sort-asc"></i></span><span ng-show="reverseSort">&nbsp;&nbsp;&nbsp; <i class="fa fa-sort-desc"></i></span></span>
                    </a>
                  </th>
                  <th style="max-width:125px;width:125px;width:125px;">
                    <a style="text-decoration: none" href="#" ng-click="orderByField='status'; reverseSort = !reverseSort">
                      Status <span ng-show="orderByField === 'status'"><span ng-show="!reverseSort"> &nbsp;&nbsp;&nbsp; <i class="fa fa-sort-asc"></i></span><span ng-show="reverseSort">&nbsp;&nbsp;&nbsp; <i class="fa fa-sort-desc"></i></span></span>
                    </a>
                    <small class="pull-right" id="filterMetrics" >
                    <i class="fa fa-bookmark text-success" aria-hidden="true"  ng-click="blnReview = (blnReview)? '':'Review'"></i>&nbsp;&nbsp;
                    <i class="fa fa-question-circle orange" aria-hidden="true" ng-click="blnSuffix = (blnSuffix)? '':'Missing'"></i>&nbsp;&nbsp;
                  </small>

                  </th>
                </tr>
                <tr>
                  <th style="max-width:125px;width:125px;min-width:20px;">
                    <input style="width:100%" ng-model="searchActor" placeholder="Actor name">
                  </th>
                  <th id="searchName" style="max-width:650px;width:auto">
                    <input style="width:100%" ng-model="searchName">
                  </th>
                  <th style="width:250px;">
                    <input style="width:100%" ng-model="searchContext">
                  </th>
                  <th style="max-width:125px;width:125px;min-width:20px;">
                    <input style="width:100%" ng-model="searchStart" placeholder="YYYY-MM-DD">
                  </th>
                  <th style="max-width:125px;width:125px;min-width:20px;">
                    <input style="width:100%" ng-model="searchEnd" placeholder="YYYY-MM-DD">
                  </th>
                  <th style="max-width:125px;width:125px;width:150px;">
                    <input style="width:100%" ng-model="searchStatus" >
                  </th>
                </tr>
              </thead>
              <tbody infinite-scroll="getMoreData()" infinite-scroll-distance="3">
                <tr id="rowTask" ng-repeat="task in obeya.tasks.allTasks">
                  <td style="text-align: left">
                    <div >
                    <!-- <div uib-tooltip-html="'Name : <b>{{task.actors[0].name}}</b>'" tooltip-placement="top"> -->
                      <img alt="" ng-src="{{ task.actors[0].avatar || 'assets/images/avatars/' + task.actors[0]._id + '.png'}} " class="img-circle" err-src="assets/images/avatars/avatar.png"/>
                      <span class="text-muted" ng-if="task.actors.length===1"> {{task.actors[0].name.split(' ')[0] }}</span>
                      <span class="text-muted" ng-if="task.actors.length>1">+{{task.actors.length -1 }}</span>
          <img  ng-if="task.actors.length>1" src="assets/images/avatars/avatar.png" class="img-circle" alt="">
                    </div>
                  </td>
                  <td >
                    <!-- Checkbox for multi selection -->
                    <div  class="abc-checkbox abc-checkbox-primary pull-right">
                      <input id="checkbox{{task._id}}" class="styled" type="checkbox" ng-model="task.selected">
                      <label for="checkbox{{task._id}}">
                      </label>
                    </div>
                    <a  href="/task/{{task._id}}" target="_blank">
                      <div id="taskName" class="dont-break-out " ng-bind-html="task.name">
                      </div>
                    </a>
                    <small class="dont-break-out text-muted">  {{task.activity}}</small>
                  </td>
                  <td >
                      <small class="dont-break-out" style="font-size:11px"> {{task.context}}</small>

                  </td>
                  <td class="hidden-xs">
                    {{task.metrics[task.metrics.length - 1].targetstartDate | date:'mediumDate'}}<br/>


                    <span class="label label-sm label-lightinfo" ng-if="task.metrics[task.metrics.length - 1].startDate > task.metrics[task.metrics.length - 1].targetstartDate " >&nbsp;&nbsp;{{task.metrics[task.metrics.length - 1].startDate | date:'mediumDate'}}</span>
                  </td>
                  <td class="hidden-xs">
                    {{task.metrics[task.metrics.length - 1].targetEndDate | date:'mediumDate'}}<br/>

                    <span class="label label-sm label-danger"  ng-if="task.metrics[task.metrics.length - 1].endDate > task.metrics[task.metrics.length - 1].targetEndDate">&nbsp;&nbsp;{{task.metrics[task.metrics.length - 1].endDate | date:'mediumDate'}}</span>
                  </td>
                  <td class="hidden-xs">

                  <span ng-if="task.metrics[task.metrics.length - 1].status ==='Not Started' "
                    class="label label-sm"
                    ng-class="{'label-info':task.metrics[task.metrics.length - 1].status ==='In Progress','label-success':task.metrics[task.metrics.length - 1].status ==='Finished','label-default':task.metrics[task.metrics.length - 1].status ==='Not Started','label-lightgrey':task.metrics[task.metrics.length - 1].status =='Withdrawn','label-warning':task.metrics[task.metrics.length - 1].startDate < today}">
                    {{task.metrics[task.metrics.length - 1].status}}
                  </span>
                  <span ng-if="task.metrics[task.metrics.length - 1].status !=='Not Started'"
                    class="label label-sm"
                    ng-class="{'label-info':task.metrics[task.metrics.length - 1].status ==='In Progress','label-success':task.metrics[task.metrics.length - 1].status ==='Finished','label-default':task.metrics[task.metrics.length - 1].status ==='Not Started','label-lightgrey':task.metrics[task.metrics.length - 1].status =='Withdrawn'}">
                    {{task.metrics[task.metrics.length - 1].status}}
                  </span>
                &nbsp;  <span ng-bind-html="task.icons"></span>
                  <span ng-bind-html="task.taskIncompleteIcon"></span>
                  <br>
                    <span>{{task.metrics[task.metrics.length - 1].targetLoad}} </span>
                      <span  ng-if="task.metrics[task.metrics.length - 1].projectedWorkload > task.metrics[task.metrics.length - 1].targetLoad">
                        &gt;&gt; <span class="label label-sm label-danger "> {{task.metrics[task.metrics.length - 1].projectedWorkload}}</span>
                      </span>
                      <span  ng-if="task.metrics[task.metrics.length - 1].projectedWorkload < task.metrics[task.metrics.length - 1].targetLoad">
                        &gt;&gt; <span class="label label-sm label-lightwarning "> {{task.metrics[task.metrics.length - 1].projectedWorkload}}</span>
                      </span>
                      <small class="text-muted " ng-if="task.metrics[task.metrics.length - 1].status ==='In Progress'">
                      <i>&nbsp;&nbsp;{{task.metrics[task.metrics.length - 1].progress}}%</i>
                    </small>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>

            <div id="dashboard_timeline" ng-if="viewMode.Tasks==='Timeline'">
                <vis-timeline data="timelineDataTasks" options="timelineOptions"></vis-timeline>
            </div>

            <div id="dashboard_calendar" ng-if="viewMode.Tasks==='Calendar'">

            <div class="row">
            <div class="col-md-12 col-sm-12">
              <div class="portlet">
                <div class="portlet-title">
                  <div class="caption">
                    <i class="fa fa-tasks"></i>Calendar

                  </div>
                  <div class="tools">
                    <div class="btn-group">

                      <button
                        class="btn btn-xs btn-primary"
                        mwl-date-modifier
                        date="viewDate"
                        decrement="calendarView"
                        ng-click="cellIsOpen = false">
                        Previous
                      </button>
                      <button
                        class="btn btn-xs btn-default"
                        mwl-date-modifier
                        date="viewDate"
                        set-to-today
                        ng-click="cellIsOpen = false">
                        Today
                      </button>
                      <button
                        class="btn btn-xs btn-primary"
                        mwl-date-modifier
                        date="viewDate"
                        increment="calendarView"
                        ng-click="cellIsOpen = false">
                        Next
                      </button>
                    </div>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                      <div class="btn-group">
                        <label class="btn btn-xs btn-primary" ng-model="calendarView" uib-btn-radio="'year'" ng-click="cellIsOpen = false">Year</label>
                        <label class="btn btn-xs btn-primary" ng-model="calendarView" uib-btn-radio="'month'" ng-click="cellIsOpen = false">Month</label>
                        <label class="btn btn-xs btn-primary" ng-model="calendarView" uib-btn-radio="'week'" ng-click="cellIsOpen = false">Week</label>
                      </div>
                  </div>
                </div>
                <div class="portlet-body">
                <div class="row">
                  <div class="col-md-12 col-sm-12">

                  <mwl-calendar
                    view="calendarView"
                    view-date="viewDate"
                    events="obeya.tasks.events"
                    view-title="calendarTitle"
                    cell-is-open="true"
                    on-event-times-changed="eventTimesChanged(calendarEvent, calendarNewEventStart, calendarNewEventEnd); calendarEvent.startsAt = calendarNewEventStart; calendarEvent.endsAt = calendarNewEventEnd"
                    on-event-click="eventClicked(calendarEvent);">
                </mwl-calendar>
                </div>
                </div>
                </div>
              </div>
            </div>


            </div>
</div>
            <div class="row" ng-if="viewMode.Tasks==='PDCA'">
                <!--############### PLAN ############  -->

                <div class="col-lg-3 col-md-6 col-sm-12" ng-class="{'label-default':task.metrics[0].status ==='Not Started'}" style="padding-bottom:10px;">
                    <div class="pdcaCol" ng-class="{'label-default':task.metrics[0].status ==='Not Started'}">
                        PLAN
                        <div class="pull-right" ng-if="task.metrics[0].status ==='Not Started'">
                            <span class="label" ng-class="{'label-info':task.metrics[0].status ==='In Progress','label-success':task.metrics[0].status ==='Finished','label-default':task.metrics[0].status ==='Not Started','label-lightgrey':task.metrics[0].status =='Withdrawn'}">
                                    {{task.metrics[0].status}}
                                  </span>
                        </div>
                    </div>

                    <!-- Tasks -->
                    <div class="portlet sale-summary">
                        <div class="portlet-title">
                            <div class="caption">
                                Planned Tasks
                            </div>
                            <div class="tools">
                                <div class="pull-right" ng-init="PlanTasksIsExpanded=true" ng-click="PlanTasksIsExpanded=!PlanTasksIsExpanded">
                                    <svg class="svgIcon " style="width:16px;height:16px;color:#B9BCC0;fill:grey" ng-show="!PlanTasksIsExpanded" viewbox="0 0 32 32" title="expand header"><g><g><polygon points="24.158,16.274 22.385,14.5 15.939,20.824 9.615,14.5 7.842,16.274 16,24.432"></polygon></g><g><polygon points="24.158,9.342 22.385,7.568 15.939,13.892 9.615,7.568 7.842,9.342 16,17.5"></polygon></g></g></svg>
                                    <svg class="svgIcon " style="width:16px;height:16px;color:#B9BCC0;fill:grey" ng-show="PlanTasksIsExpanded" viewbox="0 0 32 32" title="collapse header"><g><g><polygon points="7.842,15.726 9.615,17.5 16.061,11.176 22.385,17.5 24.158,15.726 16,7.568"></polygon></g><g><polygon points="7.842,22.658 9.615,24.432 16.061,18.108 22.385,24.432 24.158,22.658 16,14.5"></polygon></g></g></svg>
                                </div>
                                <span class="pull-right" style="margin-right:15px;">
                                    <i class="fa fa-hashtag" aria-hidden="true"></i><span class="text-info">  {{obeya.tasks.filterPlan.length}}</span>&nbsp;&nbsp;
                                <i class="fa fa-clock-o" aria-hidden="true"></i><span class="text-info">  {{obeya.tasks.filterPlanLoad}} </span><small>MD</small>
                                </span>
                            </div>
                        </div>
                        <img ng-show="!obeya.tasks.filterPlan" src="assets/images/horizontal-loader.gif" class="img-responsive" />
                        <div class="portlet-body" ng-show="PlanTasksIsExpanded" style="padding:0!important;height:100%;overflow:auto">
                            <table class="table table-striped table-hover">
                                <tbody style="text-align:left;">
                                    <tr style="background:#eee;text-align:right">
                                        <td colspan="3">
                                            <a href="#" class="btn btn-outline btn-primary" ng-click="createNewTask('both')">
                                          <i class="fa fa-plus"></i>
                                          <span class="dont-break-out"> Create a new task</span>
                                        </a >
                                      </td>
                                  </tr>
                                    <tr ng-repeat="task in obeya.tasks.filterPlan | orderBy:'metrics[0].targetEndDate'">
                                      <td style="text-align: center">
                                        <img alt="" ng-src="{{task.actors[0].avatar}}" class="img-circle" style="width:30px;height:30px;" err-src="assets/images/avatars/avatar.png" uib-tooltip-html="'Name <br /> {{task.actors[0].name}}'" tooltip-placement="top"/>
                                      </td>
                                        <td >
                                            <a href="/task/{{task._id}}">
                                              <small class="dont-break-out">  {{task.name}}</small>
                                            </a >
                                        </td>
                                        <td style="min-width:80px" ng-class="{'bg-danger':task.taskAlertIcon.length >0}">
                                            <span class="pull-right text-info">
                                              <small style="color:black" >
                                                {{ (task.metrics[0].targetEndDate | date:'dd MMM yy') }}
                                                <br>
                                              </small>
                                              <small class="text-muted" >
                                                {{ task.metrics[0].progress  }}% <span  ng-bind-html="task.taskAlertIcon"></span>
                                              </small>
                                            </span>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>

                          </div>

                      </div>


                  </div>
                  <!--############### DO ############  -->
                  <div class="col-lg-3 col-md-6 col-sm-12" ng-class="{'label-info':task.metrics[0].status ==='In Progress'}" style="padding-bottom:20px;">
                      <div class="pdcaCol" ng-class="{'label-info':task.metrics[0].status ==='In Progress'}">
                          DO
                          <div class="pull-right" ng-if="task.metrics[0].status ==='In Progress'">
                              <span class="label" ng-class="{'label-info':task.metrics[0].status ==='In Progress','label-success':task.metrics[0].status ==='Finished','label-default':task.metrics[0].status ==='Not Started','label-lightgrey':task.metrics[0].status =='Withdrawn'}">
                                    {{task.metrics[0].status}}
                                  </span>
                          </div>
                          <div class="pull-right">
                            <button type="button" name="button" style="margin-left:5px;" class="btn btn-xs btn-outline btn-warning" ng-click="reopen()" ng-if="task.metrics[0].status ==='Finished' ">ReOpen</button>
                          </div>
                      </div>

                      <!--In Progress Tasks  -->
                      <div class="portlet sale-summary" >
                          <div class="portlet-title">
                              <div class="caption">
                                  In Progress Tasks
                              </div>
                              <div class="tools">
                                  <div class="pull-right" ng-init="InProgressTasksIsExpanded=true" ng-click="InProgressTasksIsExpanded=!InProgressTasksIsExpanded">
                                      <svg class="svgIcon " style="width:16px;height:16px;color:#B9BCC0;fill:grey" ng-show="!InProgressTasksIsExpanded" viewbox="0 0 32 32" title="expand header"><g><g><polygon points="24.158,16.274 22.385,14.5 15.939,20.824 9.615,14.5 7.842,16.274 16,24.432"></polygon></g><g><polygon points="24.158,9.342 22.385,7.568 15.939,13.892 9.615,7.568 7.842,9.342 16,17.5"></polygon></g></g></svg>
                                      <svg class="svgIcon " style="width:16px;height:16px;color:#B9BCC0;fill:grey" ng-show="InProgressTasksIsExpanded" viewbox="0 0 32 32" title="collapse header"><g><g><polygon points="7.842,15.726 9.615,17.5 16.061,11.176 22.385,17.5 24.158,15.726 16,7.568"></polygon></g><g><polygon points="7.842,22.658 9.615,24.432 16.061,18.108 22.385,24.432 24.158,22.658 16,14.5"></polygon></g></g></svg>
                                  </div>
                                  <i class="fa fa-hashtag" aria-hidden="true"></i><span class="text-info">  {{obeya.tasks.filterInProgress.length}}</span>&nbsp;&nbsp;
                                  <i class="fa fa-clock-o" aria-hidden="true"></i><span class="text-info">  {{obeya.tasks.filterInProgressLoad}} </span><small>MD</small>
                              </div>
                          </div>
                          <img ng-show="!obeya.tasks.filterInProgress" src="assets/images/horizontal-loader.gif" class="img-responsive"/>

                          <div class="portlet-body" style="padding:0!important;height:100%;overflow:auto" ng-show="InProgressTasksIsExpanded">
                            <table class="table table-striped table-hover">
                                <tbody style="text-align:left;">
                                    <tr ng-repeat="task in obeya.tasks.filterInProgress | orderBy:'metrics[0].endDate'">
                                      <td style="text-align: center">
                                        <img alt="" ng-src="{{task.actors[0].avatar}}" class="img-circle" style="width:30px;height:30px;" err-src="assets/images/avatars/avatar.png" uib-tooltip-html="'Name <br /> {{task.actors[0].name}}'" tooltip-placement="top"/>
                                      </td>
                                        <td>
                                          <a href="/task/{{task._id}}">
                                          <small class="dont-break-out"> {{task.name}}</small>
                                          </a >
                                        </td>
                                        <td style="min-width:70px"  ng-class="{'bg-danger':task.taskAlertIcon.length >0}">
                                            <span class="pull-right text-info">
                                              <small style="color:black" >
                                                {{ (task.metrics[0].endDate || task.metrics[0].targetEndDate | date:'MMM, dd') }}
                                                <br>
                                              </small>
                                              <small class="text-muted" >
                                                {{ task.metrics[0].progress  }}% <span  ng-bind-html="task.taskAlertIcon"></span>
                                              </small>
                                            </span>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>

                          </div>
                          <div style="border-top:1px solide grey;width:100%">
                            &nbsp;
                          </div>
                      </div>

                      <!-- Alerts -->
                      <div class="" id="Alert" style="margin-bottom:0!important">
                          <div class="portlet sale-summary" ng-if="dashboard._id">
                              <div class="portlet-title">
                                  <div class="caption">
                                      Alerts
                                  </div>
                                  <div class="tools">
                                    <div class="pull-right" ng-init="AlertIsExpanded=true" ng-click="AlertIsExpanded=!AlertIsExpanded">
                                        <svg class="svgIcon " style="width:16px;height:16px;color:#B9BCC0;fill:grey" ng-show="!AlertIsExpanded" viewbox="0 0 32 32" title="expand header"><g><g><polygon points="24.158,16.274 22.385,14.5 15.939,20.824 9.615,14.5 7.842,16.274 16,24.432"></polygon></g><g><polygon points="24.158,9.342 22.385,7.568 15.939,13.892 9.615,7.568 7.842,9.342 16,17.5"></polygon></g></g></svg>
                                        <svg class="svgIcon " style="width:16px;height:16px;color:#B9BCC0;fill:grey" ng-show="AlertIsExpanded" viewbox="0 0 32 32" title="collapse header"><g><g><polygon points="7.842,15.726 9.615,17.5 16.061,11.176 22.385,17.5 24.158,15.726 16,7.568"></polygon></g><g><polygon points="7.842,22.658 9.615,24.432 16.061,18.108 22.385,24.432 24.158,22.658 16,14.5"></polygon></g></g></svg>
                                    </div>
                                    <span class="pull-right" style="margin-right:15px;"><small>Number:</small>  <span class="text-info">  {{dashboard.alerts.length}}</span></span>
                                  </div>
                              </div>
                              <div class="portlet-body" style="padding:0!important;max-height:100%;overflow:auto" ng-show="AlertIsExpanded">
                                  <table class="table table-striped table-hover">
                                      <tbody style="text-align:center;">
                                          <tr ng-repeat="KPI in dashboard.alerts | orderBy:'constraint' track by $index" on-finish-render uib-tooltip-html="'Contraint : {{KPI.constraint}}<br /> <br /> Description :  {{KPI.description}}  <br /> Suggestion :  {{KPI.suggestion}}'" tooltip-placement="right"  tooltip-class="tooltipkpi" >
                                              <td style="text-align:left;width:75%">
                                                <a href="/KPI/{{KPI.alertId}}?type=dashboard&typeid={{dashboard._id}}&rangedate={{datediff}}">{{KPI.name}}</a>
                                        </td>
                                        <td style="text-align:left;width:25%;font-size:13px">
                                            <span ng-if="KPI.calcul[rangeDate] !== undefined && KPI.calcul[rangeDate] !== null" class="badge" ng-style="{'background-color':giveMeMyColor(KPI.calcul[rangeDate], KPI.category)}" style="height:15px;line-height:10px;width:15px;margin-right: 10px">&nbsp;</span>
                                            <span class="text-muted">
                                                    {{KPI.calcul[rangeDate]}}
                                                  </span>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <div style="border-top:1px solide grey;width:100%">
                            &nbsp;
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-3 col-md-6 col-sm-12" ng-class="{'label-success':task.metrics[0].status ==='Finished','label-lightgrey':task.metrics[0].status =='Withdrawn'}" style="padding-bottom:20px;">
                <div class="pdcaCol" ng-class="{'label-success':task.metrics[0].status ==='Finished','label-lightgrey':task.metrics[0].status =='Withdrawn'}">
                    CHECK
                    <div class="pull-right" ng-if="task.metrics[0].status ==='Finished' || task.metrics[0].status =='Withdrawn'">
                        <span class="label">
                                    {{task.metrics[0].status}}
                                  </span>
                    </div>
                </div>


                <!--Finished Tasks  -->
                <div class="portlet sale-summary">
                    <div class="portlet-title">
                        <div class="caption" uib-tooltip-html="'(not reviewed)'" tooltip-placement="bottom">
                            Finished Tasks
                        </div>
                        <div class="tools">
                            <div class="pull-right" ng-init="FinishedTasksIsExpanded=true" ng-click="FinishedTasksIsExpanded=!FinishedTasksIsExpanded">
                                <svg class="svgIcon " style="width:16px;height:16px;color:#B9BCC0;fill:grey" ng-show="!FinishedTasksIsExpanded" viewbox="0 0 32 32" title="expand header"><g><g><polygon points="24.158,16.274 22.385,14.5 15.939,20.824 9.615,14.5 7.842,16.274 16,24.432"></polygon></g><g><polygon points="24.158,9.342 22.385,7.568 15.939,13.892 9.615,7.568 7.842,9.342 16,17.5"></polygon></g></g></svg>
                                <svg class="svgIcon " style="width:16px;height:16px;color:#B9BCC0;fill:grey" ng-show="FinishedTasksIsExpanded" viewbox="0 0 32 32" title="collapse header"><g><g><polygon points="7.842,15.726 9.615,17.5 16.061,11.176 22.385,17.5 24.158,15.726 16,7.568"></polygon></g><g><polygon points="7.842,22.658 9.615,24.432 16.061,18.108 22.385,24.432 24.158,22.658 16,14.5"></polygon></g></g></svg>
                            </div>
                            <i class="fa fa-hashtag" aria-hidden="true"></i><span class="text-info">  {{obeya.tasks.filterFinished.length}}</span>&nbsp;&nbsp;
                            <i class="fa fa-clock-o" aria-hidden="true"></i><span class="text-info">  {{obeya.tasks.filterFinishedLoad}} </span><small>MD</small>

                        </div>
                    </div>
                    <img ng-show="!obeya.tasks.filterFinished" src="assets/images/horizontal-loader.gif" class="img-responsive" />

                    <div class="portlet-body" style="padding:0!important;height:100%;overflow:auto" ng-show="FinishedTasksIsExpanded">
                        <table class="table table-striped table-hover">
                            <tbody style="text-align:left;">
                                <tr ng-repeat="task in obeya.tasks.filterFinished | orderBy:'-metrics[0].endDate'">
                                    <td style="text-align: center">
                                        <img alt="" ng-src="{{task.actors[0].avatar}}" class="img-circle" style="width:30px;height:30px;" err-src="assets/images/avatars/avatar.png" uib-tooltip-html="'Name <br /> {{task.actors[0].name}}'" tooltip-placement="top" />
                                    </td>
                                    <td>
                                        <a href="/task/{{task._id}}">
                                              <small class="dont-break-out"></span> {{task.name}}</small>

                                            </a >
                                          </td>
                                          <td style="min-width:70px"  ng-class="{'bg-warning':task.taskIncompleteIcon.length >0}">
                                              <span class="pull-right text-info">
                                                <small class="text-muted" >
                                                  {{ (task.metrics[0].endDate | date:'MMM, dd') }}
                                                </small>
                                                <br>
                                                <span  ng-bind-html="task.taskIncompleteIcon">
                                              </span>
                                          </td>
                                      </tr>
                                  </tbody>
                              </table>

                          </div>
                          <div style="border-top:1px solide grey;width:100%">
                            &nbsp;
                          </div>
                      </div>

                  </div>
                  <div class="col-lg-3 col-md-6 col-sm-12" ng-class="{'label-success':task.metrics[0].status ==='Finished','label-lightgrey':task.metrics[0].status =='Withdrawn'}" style="padding-bottom:20px;">
                      <div class="pdcaCol">
                          ACT <small class="text-muted">(Review)</small>
                      </div>
                      <!-- Review -->
                      <div class="portlet sale-summary" >
                          <div class="portlet-title">
                              <div class="caption">
                                  Reviewed Tasks
                              </div>
                              <div class="tools">
                                  <div class="pull-right" ng-init="ReviewedTasksIsExpanded=true" ng-click="ReviewedTasksIsExpanded=!ReviewedTasksIsExpanded">
                                      <svg class="svgIcon " style="width:16px;height:16px;color:#B9BCC0;fill:grey" ng-show="!ReviewedTasksIsExpanded" viewbox="0 0 32 32" title="expand header"><g><g><polygon points="24.158,16.274 22.385,14.5 15.939,20.824 9.615,14.5 7.842,16.274 16,24.432"></polygon></g><g><polygon points="24.158,9.342 22.385,7.568 15.939,13.892 9.615,7.568 7.842,9.342 16,17.5"></polygon></g></g></svg>
                                      <svg class="svgIcon " style="width:16px;height:16px;color:#B9BCC0;fill:grey" ng-show="ReviewedTasksIsExpanded" viewbox="0 0 32 32" title="collapse header"><g><g><polygon points="7.842,15.726 9.615,17.5 16.061,11.176 22.385,17.5 24.158,15.726 16,7.568"></polygon></g><g><polygon points="7.842,22.658 9.615,24.432 16.061,18.108 22.385,24.432 24.158,22.658 16,14.5"></polygon></g></g></svg>
                                  </div>
                                  <i class="fa fa-hashtag" aria-hidden="true"></i><span class="text-info">  {{obeya.tasks.filterReviewed.length}}</span>&nbsp;&nbsp;
                                  <i class="fa fa-clock-o" aria-hidden="true"></i><span class="text-info">  {{obeya.tasks.filterReviewedLoad}} </span><small>MD</small>
                              </div>
                          </div>
                          <img ng-show="!obeya.tasks.filterReviewed" src="assets/images/horizontal-loader.gif" class="img-responsive"/>

                          <div class="portlet-body" style="padding:0!important;height:100%;overflow:auto" ng-show="ReviewedTasksIsExpanded">
                              <table class="table table-striped table-hover">
                                  <tbody style="text-align:left;">
                                      <tr ng-repeat="task in obeya.tasks.filterReviewed | orderBy:'-metrics[0].endDate'">
                                        <td style="text-align: center">
                                          <img alt="" ng-src="{{task.actors[0].avatar}}" class="img-circle" style="width:30px;height:30px;" err-src="assets/images/avatars/avatar.png" uib-tooltip-html="'Name <br /> {{task.actors[0].name}}'" tooltip-placement="top"/>
                                        </td>
                                          <td>
                                            <a href="/task/{{task._id}}">
                                              <small class="dont-break-out"> {{task.name}}</small>

                                            </a >
                                          </td>
                                          <td style="min-width:70px"   ng-class="{'bg-warning':task.taskIncompleteIcon.length >0}">
                                              <span class="pull-right text-info">
                                                <small class="text-muted" >
                                                  {{ (task.metrics[0].endDate | date:'MMM, dd') }}
                                                  <br>
                                                  <span  ng-bind-html="task.taskIncompleteIcon"></span>
                                                </small>
                                              </span>
                                          </td>
                                      </tr>
                                  </tbody>
                              </table>

                          </div>
                          <div style="border-top:1px solide grey;width:100%">
                            &nbsp;
                          </div>
                      </div>

                      <!-- Review -->
                      <div class="" id="Review">
                          <div class="portlet sale-summary" ng-if="dashboard._id === 1">
                              <div class="portlet-title">
                                  <div class="caption">
                                      Review
                                  </div>
                                  <div class="tools">
                                      <div class="pull-right" ng-click="ReviewIsExpanded=!ReviewIsExpanded">
                                          <svg class="svgIcon " style="width:16px;height:16px;color:#B9BCC0;fill:grey" ng-show="!ReviewIsExpanded" viewbox="0 0 32 32" title="expand header"><g><g><polygon points="24.158,16.274 22.385,14.5 15.939,20.824 9.615,14.5 7.842,16.274 16,24.432"></polygon></g><g><polygon points="24.158,9.342 22.385,7.568 15.939,13.892 9.615,7.568 7.842,9.342 16,17.5"></polygon></g></g></svg>
                                          <svg class="svgIcon " style="width:16px;height:16px;color:#B9BCC0;fill:grey" ng-show="ReviewIsExpanded" viewbox="0 0 32 32" title="collapse header"><g><g><polygon points="7.842,15.726 9.615,17.5 16.061,11.176 22.385,17.5 24.158,15.726 16,7.568"></polygon></g><g><polygon points="7.842,22.658 9.615,24.432 16.061,18.108 22.385,24.432 24.158,22.658 16,14.5"></polygon></g></g></svg>
                                      </div>
                                      <span class="pull-right" style="margin-right:15px;"><small>Number:</small>  <span class="text-info">  {{task.reviews.length ||0}}</span></span>
                                  </div>
                              </div>
                              <div class="portlet-body" style="padding:0!important;max-height:100%;overflow:auto" ng-show="ReviewIsExpanded">
                                <table class="table table-striped table-hover">
                                    <tbody style="text-align:center;">
                                        <tr >
                                            <td style="text-align:left;">Task Review</td>
                                            <td style="text-align:right;padding-right:25px;font-size:13px">
                                              <div class="circularButtonView circularToggleButtonView-button circularButtonView--xsmall circularButtonView--onWhiteBackground circularButtonView--active">
                                                  <span class="circularButtonView-label">
                                                    <svg class="svgIcon " viewbox="0 0 32 32" title="checkmark">
                                                      <polygon points="27.672,4.786 10.901,21.557 4.328,14.984 1.5,17.812 10.901,27.214 30.5,7.615 "></polygon>
                                                    </svg>
                                                  </span>
                                              </div>
                                            </td>
                                        </tr>
                                        <tr >
                                            <td style="text-align:left;">Perimeter Review</td>
                                            <td style="text-align:right;padding-right:25px;font-size:13px">
                                              <div class="circularButtonView circularToggleButtonView-button circularButtonView--xsmall circularButtonView--onWhiteBackground circularButtonView--active">
                                                  <span class="circularButtonView-label">
                                                    <svg class="svgIcon " viewbox="0 0 32 32" title="checkmark">
                                                      <polygon points="27.672,4.786 10.901,21.557 4.328,14.984 1.5,17.812 10.901,27.214 30.5,7.615 "></polygon>
                                                    </svg>
                                                  </span>
                                              </div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                              </div>
                          </div>
                      </div>

                  </div>
              </div>

<div class="row" ng-if="viewMode.Tasks==='overview'" style="padding:5px 15px 5px 15px;">

  <!-- BEGIN OVERVIEW STATISTIC BARS-->
  <div class="row stats-overview-cont" >
    <div class="col-md-2 col-sm-2">
      <div class="stats-overview stat-block">
        <div class="details">
          <div class="title" style="height:61px">
                All Tasks Nb : <span style="color:#9467bd">{{obeya.tasks.alltasksNb}}</span>
        </div>
      </div>
    </div>
    </div>
    <div class="col-md-10 col-sm-10">
      <div class="stats-overview stat-block">
        <div class="details">
          <div class="title">
            <a href="#" ng-click="blnShowAllTasks=!blnShowAllTasks">
              <span style="font-weight:bold;color:#9467bd">{{obeya.tasks.tasksNb | number:0}}</span>
              Tasks</a>
                    </div>
                    <nvd3 options="obeya.tasks.optionsTasks" data="obeya.tasks.dataTasks" ng-if="viewMode.Tasks==='overview'"></nvd3>
                </div>
            </div>
        </div>
    </div>
    <div class="row stats-overview-cont" >
      <div class="col-md-2 col-sm-2">
        <div class="stats-overview stat-block">
          <div class="details">
            <div class="title" style="height:61px">
                  All Workload : <span style="color:#9467bd">{{obeya.tasks.workloadSum}}</span>
            </div>
          </div>
        </div>
      </div>
          <div class="col-md-10 col-sm-10">
              <div class="stats-overview stat-block">
                  <div class="details">
                      <div class="title">
                          <a href="#" ng-click="blnShowAllTasks=!blnShowAllTasks">
                <span style="font-weight:bold;color:#87CEEB">{{obeya.tasks.metricsNb | number:0}}</span>
                Workload</a>
                      </div>
                      <nvd3 options="obeya.tasks.optionsLoad" data="obeya.tasks.dataMetrics" ng-if="viewMode.Tasks==='overview'"></nvd3>
                  </div>
              </div>
          </div>

      </div>
    <!-- END OVERVIEW STATISTIC BARS-->

</div>

</div>
</div>
</div>
<!-- END TASKS -->
