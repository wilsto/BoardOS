<div ng-include="'components/navbar/navbar.html'"></div>
<div ng-click="toggle()" style="z-index:999;position:absolute;right:-35px;top:35% ;background-color:#222222;width:70px;height:70px;  border-radius: 35px;    -webkit-transform:rotate(-90deg);   -ms-transform:rotate(-90deg);    -moz-transform:rotate(-90deg);    -webkit-transform:rotate(-90deg);    -o-transform:rotate(-90deg);">
<div style="font-size:14px;color:#FFF;width:70px;height:70px;text-align:center;padding-top:10px; ">Menu</div>
</div>
<script type="text/ng-template" id="reOpenAnomaly.html">
  <div class="modal-header">
      <h4 class="modal-title">WhOops, looks like something went wrong.
        <img src="assets/images/problem.jpg" style="height:150px;margin:5px" class="pull-right"/>
<small>
<br/>
Please report with maximum of accucracy your problem to be able to correct it and prevent it to appear again.
<br />
</small>
      </h4>
  </div>
  <div class="modal-body" id="modal-body-{{name}}">
      <table class="table table-striped table-hover">
          <tbody style="text-align:left;">
            <tr >
                <td style="text-align:left">
                    <span class="text-muted">Resume
                    </span>
                </td>
                <td style="text-align:right">
                  <a href="#"  e-style="resize:vertical;width:100%"  editable-textarea="selected.name" buttons="no" blur="submit">{{ selected.name || 'To Complete ' }}</a>
                </td>
            </tr>
            <tr >
                <td style="text-align:left">
                    <span class="text-muted">Category
                    </span>
                </td>
                <td style="text-align:right">
                  <a href="#" editable-checklist="selected.category" e-ng-options="c.value as c.text for c in categories" buttons="no" blur="submit">
                    {{ showCategories() }}
                  </a>
                </td>
            </tr>
            <tr>
                <td style="text-align:left">
                    <span class="text-muted">Impacts
                  </span>
                </td>
                <td style="text-align:right" >
                  <a href="#" editable-select="selected.impact" e-ng-options="c.value as c.text for c in impacts" buttons="no" blur="submit" >
                    {{ showImpacts() }}
                  </a>
                  <a href="#" ng-show="selected.impact" class="days"  e-min="0" e-step="0.001" editable-number="selected.impactWorkload" style="margin-left:10px" e-style="width: 100px;"  buttons="no" blur="submit">{{ selected.impactWorkload || ' Give Details ' }}</a>

                </td>
            </tr>
            <tr uib-tooltip-html="'Give maximum of details to describe the problem with facts : Timeline, KPIs, Process, ... <br /> <br /> You need to be sure that all people who will work on this problem have the same understanding<br /> <br /> Text Area can be enlarge'" tooltip-placement="left">
            <td style="text-align:left">
              <span class="text-muted" >
                Details <small></small>
              </span>
            </td>
            <td style="text-align:right">
              <a href="#"  e-style="resize:vertical;width:100%" editable-textarea="selected.details" buttons="right">{{ selected.details || 'To Complete ' }}</a>
            </td>
          </tr>
          <tr>
              <td style="text-align:left">
                  <span class="text-muted">Due Date
                  </span>
              </td>
              <td>
                  <span class="pull-right text-info">
                    <!-- <a href="#" editable-bsdate="task.metrics[task.metrics.length-1].targetEndDate" e-is-open="opened.$data" e-ng-click="open($event,'$data')" e-datepicker-popup="mediumDate" e-readonly="true"> -->
                    <md-button class="md-button-slim" ng-click="showDatePicker(selected,'dueDate', $event)" aria-label="none" >
                      <span ng-class="{'MandatoryField':selected.dueDate === undefined}"> {{ (selected.dueDate | date:'mediumDate') || 'empty' }}</span>
                    </md-button>
                    <!-- </a> -->
                  </span>
              </td>
          </tr>
          </tbody>
      </table>
  </div>
  <div class="modal-footer">
          <button class="btn btn-warning" type="button" ng-click="ok()" ng-disabled="selected.name === null || selected.impact === null || selected.category === null">OK</button>
          <button class="btn btn-default pull-left" type="button" ng-click="cancel()">Cancel</button>
      </div>
</script>
<!-- *************** -->
<!-- FIRST PAGE      -->
<!-- *************** -->
<div  class="row"   ng-cloak ng-show="dashboardSlide==='Home' || !dashboard.id" cg-busy="myPromise">
<div class="col-md-12">
  <div class="row ">
    <div class="col-md-1" ng-show="blnshowConfig">
      <img src="assets/images/dashboard.png" class="img-responsive hidden-xs" style="max-height:200px;" alt=""/>
    </div>
    <div class="col-md-11" ng-show="blnshowConfig">
      <div class="row">
        <div class="col-md-6 col-sm-12">
          <h3 style="margin-top:0">
            <a href="#" style="color:black!important" editable-text="dashboard.name" e-style="width: 500px" buttons="right">{{ dashboard.name || 'Please give a name of your dashboard' }}</a>
            <span class="text-muted" style="font-size:9px;">Perimeter Details</span>
          </h3>
          <ul class="list list-inline" ng-show="blnshowConfig">
              <li style="width:100%;border:1px dotted rgb(196, 197, 205);padding:5px;" ng-repeat="perimeterValue in dashboard.perimeter">
                  <div class="row">
                    <div class="col-md-6">

                      <i class="fa fa-flash d-block"></i>
                      <span class="d-block text-muted"Process</span>
                      <a href="#" editable-text="perimeterValue.activity" class=" d-block" e-uib-typeahead="activity.longname for activity in activities | filter:$viewValue | limitTo:50">
                        {{perimeterValue.activity || 'All' }}
                      </a>
                    </div>
                    <div class="col-md-6">
                      <i class="fa fa-map-marker d-block"></i>
                        <span class="d-block text-muted">Context</span>
                      <a href="#" editable-text="perimeterValue.context" class=" d-block dont-break-out" e-uib-typeahead="context.longname for context in contexts | filter:$viewValue | limitTo:50">
                        {{perimeterValue.context || 'All' }}
                      </a>

                      <div style="height:20px;width:20px;" class="pull-right circularButtonView circularToggleButtonView-button circularButtonView--small circularButtonView--onWhiteBackground"
                            uib-tooltip-html="'Remove this perimeter from this dashboard'" tooltip-placement="right"
                         ng-click="removePerimeter(perimeterValue, $index)">
                          <span class="circularButtonView-label">
                            <svg class="svgIcon add-followers-icon" viewbox="0 0 32 32" title="minus" >
                              <polygon points="28,14 18,14 14,14 4,14 4,18 14,18 18,18 28,18"></polygon>
                            </svg>
                      </span>
                      </div>

                    </div>
                  </div>
              </li>
              <li style="width:100%;border:1px dotted rgb(196, 197, 205);padding:5px;" ng-show="blnshowConfig">
                <div class="row">
                  <div class="col-md-6">
                <div  style="height:20px;width:20px" class="circularButtonView circularToggleButtonView-button circularButtonView--small circularButtonView--onWhiteBackground" uib-tooltip-html="'Add another perimeter'" tooltip-placement="bottom" ng-init="showNewPerimeter=false" ng-click="showNewPerimeter=!showNewPerimeter">
                    <span class="circularButtonView-label">
                      <svg class="svgIcon add-followers-icon" viewbox="0 0 32 32" title="plus" >
                        <polygon points="28,14 18,14 18,4 14,4 14,14 4,14 4,18 14,18 14,28 18,28 18,18 28,18"></polygon>
                      </svg>
                </span>
                </div>
                <span ng-show="showNewPerimeter">
                <i class="fa fa-flash d-block"></i>
                <span class="d-block text-muted"Process</span>
                <a href="#" editable-text="newPerimeterValue.activity" class=" d-block" e-uib-typeahead="activity.longname for activity in activities | filter:$viewValue | limitTo:50">
                  {{newPerimeterValue.activity || 'All' }}
                </a>
              </span>
              </div>
              <div class="col-md-6" >
                <span ng-show="showNewPerimeter">
                <i class="fa fa-map-marker d-block"></i>
                  <span class="d-block text-muted">Context</span>
                <a href="#" editable-text="newPerimeterValue.context" class=" d-block dont-break-out"  e-uib-typeahead="context.longname for context in contexts | filter:$viewValue | limitTo:50">
                  {{newPerimeterValue.context || 'All' }}
                </a>
              </span>
              </div>
            </div>
              </li>
              <li style="margin-top:5px" >
                <span ng-show="messageCreation" class="label label-danger">  {{messageCreation}}</span>
              </li>
          </ul>
          <div class="pull-right" style="width:200px" ng-if="!dashboard._id" uib-tooltip-html="'You must fill at least 2 mandatories fields : name and (activity and/or context)to be able to save'" tooltip-placement="bottom">
              <button type="button" name="button" style="width:200px" class="btn  btn-primary" ng-click="create()" ng-disabled="!(dashboard.name && (dashboard.perimeter[0].context || dashboard.perimeter[0].activity))">Create</button>
          </div>
        </div>
        <!--end col-md-8-->
        <div class="col-md-2 col-sm-12 " ng-show="blnshowConfig">

          <div class="portlet sale-summary" ng-if="dashboard._id" >
              <div class="portlet-title" >
                  <div class="caption">
                      Subscribers
                  </div>
                  <div class="tools">
                      <div class="pull-right">
                          <svg class="svgIcon " style="width:16px;height:16px;color:#B9BCC0;fill:grey" ng-show="!ActionPlanIsExpanded" viewbox="0 0 32 32" title="expand header"><g><g><polygon points="24.158,16.274 22.385,14.5 15.939,20.824 9.615,14.5 7.842,16.274 16,24.432"></polygon></g><g><polygon points="24.158,9.342 22.385,7.568 15.939,13.892 9.615,7.568 7.842,9.342 16,17.5"></polygon></g></g></svg>
                          <svg class="svgIcon " style="width:16px;height:16px;color:#B9BCC0;fill:grey" ng-show="ActionPlanIsExpanded" viewbox="0 0 32 32" title="collapse header"><g><g><polygon points="7.842,15.726 9.615,17.5 16.061,11.176 22.385,17.5 24.158,15.726 16,7.568"></polygon></g><g><polygon points="7.842,22.658 9.615,24.432 16.061,18.108 22.385,24.432 24.158,22.658 16,14.5"></polygon></g></g></svg>
                      </div>
                      <span class="pull-right" style="margin-right:15px;"><small>Number:</small>  <span class="text-info">  {{dashboard.users.length ||0}}</span></span>
                  </div>
              </div>
              <div class="portlet-body"  style="height:110px;margin-bottom:5px;">
                          <div ng-repeat="user in dashboard.users" uib-tooltip-html="'Name : <b>{{user.name}}</b>'" class="pull-left">
                            <img style="margin:2px;" alt="" ng-src="{{user.avatar}}" class="img-circle" err-src="assets/images/avatars/avatar.png"/>
                          </div>
              </div>
          </div>

        </div>

        <!--end col-md-4-->
      </div>
      <!--end row-->
    </div>
  </div>

                              <button type="button" name="button" style="margin-top:2px;margin-right:10px;width:100px;" class="btn btn-primary pull-right "
                                  ng-if="needToSave && dashboard._id" ng-cloak ng-click="update()"
                                  uib-tooltip-html="'Save will  copy data to a permanent storage'" tooltip-placement="top" >Save</button>
</div>

<div class="row" ng-if="dashboardSlide==='Home' && dashboard._id">
    <!--############### PLAN ############  -->

    <div class="col-lg-3 col-md-6 col-sm-12" ng-class="{'label-default':task.metrics[0].status ==='Not Started'}" style="padding-bottom:10px;">
        <div class="pdcaCol" ng-class="{'label-default':task.metrics[0].status ==='Not Started'}">
            PLAN
            <div class="pull-right" ng-if="task.metrics[0].status ==='Not Started'">
                <span class="label" ng-class="{'label-info':task.metrics[0].status ==='In Progress','label-success':task.metrics[0].status ==='Finished','label-default':task.metrics[0].status ==='Not Started','label-lightgrey':task.metrics[0].status =='Withdrawn'}">
                      {{task.metrics[0].status}}
                    </span>
            </div>
        </div>

        <!-- Tasks -->
        <div class="portlet sale-summary" >
            <div class="portlet-title">
                <div class="caption">
                    Planned Tasks
                </div>
                <div class="tools">
                    <div class="pull-right" ng-init="PlanTasksIsExpanded=true" ng-click="PlanTasksIsExpanded=!PlanTasksIsExpanded">
                        <svg class="svgIcon " style="width:16px;height:16px;color:#B9BCC0;fill:grey" ng-show="!PlanTasksIsExpanded" viewbox="0 0 32 32" title="expand header"><g><g><polygon points="24.158,16.274 22.385,14.5 15.939,20.824 9.615,14.5 7.842,16.274 16,24.432"></polygon></g><g><polygon points="24.158,9.342 22.385,7.568 15.939,13.892 9.615,7.568 7.842,9.342 16,17.5"></polygon></g></g></svg>
                        <svg class="svgIcon " style="width:16px;height:16px;color:#B9BCC0;fill:grey" ng-show="PlanTasksIsExpanded" viewbox="0 0 32 32" title="collapse header"><g><g><polygon points="7.842,15.726 9.615,17.5 16.061,11.176 22.385,17.5 24.158,15.726 16,7.568"></polygon></g><g><polygon points="7.842,22.658 9.615,24.432 16.061,18.108 22.385,24.432 24.158,22.658 16,14.5"></polygon></g></g></svg>
                    </div>
                    <span class="pull-right" style="margin-right:15px;">
                      <i class="fa fa-hashtag" aria-hidden="true"></i><span class="text-info">  {{filteredPlanTasks.length}}</span>&nbsp;&nbsp;
                      <i class="fa fa-clock-o" aria-hidden="true"></i><span class="text-info">  {{filteredPlanTasksLoad}} </span><small>MD</small>
                    </span>
                </div>
            </div>
            <img ng-show="!filteredPlanTasks" src="assets/images/horizontal-loader.gif" class="img-responsive"/>
            <div class="portlet-body"  ng-show="PlanTasksIsExpanded" style="padding:0!important;height:400px;overflow:auto">
              <table class="table table-striped table-hover" >
                  <tbody style="text-align:left;">
                    <tr style="background:#eee;text-align:right">
                        <td colspan="3">
                          <a href="#" class="btn btn-outline btn-primary" ng-click="createNewTask('both')">
                            <i class="fa fa-plus"></i>
                            <span class="dont-break-out"> Create a new task</span>
                          </a >
                        </td>
                    </tr>
                      <tr ng-repeat="task in filteredPlanTasks | orderBy:'metrics[0].endDate'">
                        <td style="text-align: center">
                          <img alt="" ng-src="{{task.actors[0].avatar}}" class="img-circle" style="width:30px;height:30px;" err-src="assets/images/avatars/avatar.png" uib-tooltip-html="'Name <br /> {{task.actors[0].name}}'" tooltip-placement="top"/>
                        </td>
                          <td >
                              <a href="/task/{{task._id}}">
                                <small class="dont-break-out"> {{task.name}}</small>
                              </a >
                          </td>
                          <td style="min-width:70px">
                              <span class="pull-right text-info">
                                <small class="text-muted" >
                                  {{ (task.metrics[0].targetstartDate | date:'MMM, dd') }} &gt;
                                </small>
                                <small style="color:black" >
                                  {{ (task.metrics[0].endDate || task.metrics[0].targetEndDate | date:'MMM, dd') }}
                                </small>
                              </span>
                          </td>
                      </tr>
                  </tbody>
              </table>

            </div>

        </div>


    </div>
    <!--############### DO ############  -->
    <div class="col-lg-3 col-md-6 col-sm-12" ng-class="{'label-info':task.metrics[0].status ==='In Progress'}" style="padding-bottom:20px;">
        <div class="pdcaCol" ng-class="{'label-info':task.metrics[0].status ==='In Progress'}">
            DO
            <div class="pull-right" ng-if="task.metrics[0].status ==='In Progress'">
                <span class="label" ng-class="{'label-info':task.metrics[0].status ==='In Progress','label-success':task.metrics[0].status ==='Finished','label-default':task.metrics[0].status ==='Not Started','label-lightgrey':task.metrics[0].status =='Withdrawn'}">
                      {{task.metrics[0].status}}
                    </span>
            </div>
            <div class="pull-right">
              <button type="button" name="button" style="margin-left:5px;" class="btn btn-xs btn-outline btn-warning" ng-click="reopen()" ng-if="task.metrics[0].status ==='Finished' ">ReOpen</button>
            </div>
        </div>

        <!--In Progress Tasks  -->
        <div class="portlet sale-summary" >
            <div class="portlet-title">
                <div class="caption">
                    In Progress Tasks
                </div>
                <div class="tools">
                    <div class="pull-right" ng-init="InProgressTasksIsExpanded=true" ng-click="InProgressTasksIsExpanded=!InProgressTasksIsExpanded">
                        <svg class="svgIcon " style="width:16px;height:16px;color:#B9BCC0;fill:grey" ng-show="!InProgressTasksIsExpanded" viewbox="0 0 32 32" title="expand header"><g><g><polygon points="24.158,16.274 22.385,14.5 15.939,20.824 9.615,14.5 7.842,16.274 16,24.432"></polygon></g><g><polygon points="24.158,9.342 22.385,7.568 15.939,13.892 9.615,7.568 7.842,9.342 16,17.5"></polygon></g></g></svg>
                        <svg class="svgIcon " style="width:16px;height:16px;color:#B9BCC0;fill:grey" ng-show="InProgressTasksIsExpanded" viewbox="0 0 32 32" title="collapse header"><g><g><polygon points="7.842,15.726 9.615,17.5 16.061,11.176 22.385,17.5 24.158,15.726 16,7.568"></polygon></g><g><polygon points="7.842,22.658 9.615,24.432 16.061,18.108 22.385,24.432 24.158,22.658 16,14.5"></polygon></g></g></svg>
                    </div>
                    <i class="fa fa-hashtag" aria-hidden="true"></i><span class="text-info">  {{filteredInProgressTasks.length}}</span>&nbsp;&nbsp;
                    <i class="fa fa-clock-o" aria-hidden="true"></i><span class="text-info">  {{filteredInProgressTasksLoad}} </span><small>MD</small>
                </div>
            </div>
            <img ng-show="!filteredInProgressTasks" src="assets/images/horizontal-loader.gif" class="img-responsive"/>

            <div class="portlet-body" style="padding:0!important;height:400px;overflow:auto" ng-show="InProgressTasksIsExpanded">
              <table class="table table-striped table-hover">
                  <tbody style="text-align:left;">
                      <tr ng-repeat="task in filteredInProgressTasks | orderBy:'metrics[0].endDate'">
                        <td style="text-align: center">
                          <img alt="" ng-src="{{task.actors[0].avatar}}" class="img-circle" style="width:30px;height:30px;" err-src="assets/images/avatars/avatar.png" uib-tooltip-html="'Name <br /> {{task.actors[0].name}}'" tooltip-placement="top"/>
                        </td>
                          <td>
                            <a href="/task/{{task._id}}">
                            <small class="dont-break-out"> {{task.name}}</small>
                            </a >
                          </td>
                          <td style="min-width:70px">
                              <span class="pull-right text-info">
                                <small class="text-muted" >
                                  {{ task.metrics[0].progress  }}% &gt;
                                </small>
                                <small style="color:black" >
                                  {{ (task.metrics[0].endDate || task.metrics[0].targetEndDate | date:'MMM, dd') }}
                                </small>
                              </span>
                          </td>
                      </tr>
                  </tbody>
              </table>

            </div>
            <div style="border-top:1px solide grey;width:100%">
              &nbsp;
            </div>
        </div>

        <!-- Alerts -->
        <div class="" id="Alert" style="margin-bottom:0!important">
            <div class="portlet sale-summary" ng-if="dashboard._id">
                <div class="portlet-title">
                    <div class="caption">
                        Alerts
                    </div>
                    <div class="tools">
                      <div class="pull-right" ng-init="AlertIsExpanded=true" ng-click="AlertIsExpanded=!AlertIsExpanded">
                          <svg class="svgIcon " style="width:16px;height:16px;color:#B9BCC0;fill:grey" ng-show="!AlertIsExpanded" viewbox="0 0 32 32" title="expand header"><g><g><polygon points="24.158,16.274 22.385,14.5 15.939,20.824 9.615,14.5 7.842,16.274 16,24.432"></polygon></g><g><polygon points="24.158,9.342 22.385,7.568 15.939,13.892 9.615,7.568 7.842,9.342 16,17.5"></polygon></g></g></svg>
                          <svg class="svgIcon " style="width:16px;height:16px;color:#B9BCC0;fill:grey" ng-show="AlertIsExpanded" viewbox="0 0 32 32" title="collapse header"><g><g><polygon points="7.842,15.726 9.615,17.5 16.061,11.176 22.385,17.5 24.158,15.726 16,7.568"></polygon></g><g><polygon points="7.842,22.658 9.615,24.432 16.061,18.108 22.385,24.432 24.158,22.658 16,14.5"></polygon></g></g></svg>
                      </div>
                      <span class="pull-right" style="margin-right:15px;"><small>Number:</small>  <span class="text-info">  {{dashboard.alerts.length}}</span></span>
                    </div>
                </div>
                <div class="portlet-body" style="padding:0!important;max-height:400px;overflow:auto" ng-show="AlertIsExpanded">
                    <table class="table table-striped table-hover">
                        <tbody style="text-align:center;">
                            <tr ng-repeat="KPI in dashboard.alerts | orderBy:'constraint' track by $index" on-finish-render uib-tooltip-html="'Contraint : {{KPI.constraint}}<br /> <br /> Description :  {{KPI.description}}  <br /> Suggestion :  {{KPI.suggestion}}'" tooltip-placement="right"  tooltip-class="tooltipkpi" >
                                <td style="text-align:left;width:75%">
                                  <a href="/KPI/{{KPI.alertId}}?type=dashboard&typeid={{dashboard._id}}&rangedate={{datediff}}">{{KPI.name}}</a>
                                </td>
                                <td style="text-align:left;width:25%;font-size:13px">
                                    <span ng-if="KPI.calcul[rangeDate] !== undefined && KPI.calcul[rangeDate] !== null" class="badge" ng-style="{'background-color':giveMeMyColor(KPI.calcul[rangeDate], KPI.category)}" style="height:15px;line-height:10px;width:15px;margin-right: 10px">&nbsp;</span>
                                    <span class="text-muted" >
                                      {{KPI.calcul[rangeDate]}}
                                    </span>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div style="border-top:1px solide grey;width:100%">
                  &nbsp;
                </div>
            </div>
        </div>

        <!-- Anomalies -->
        <div class="" id="Anomalies">
            <div class="portlet sale-summary" ng-if="dashboard._id">
                <div class="portlet-title">
                    <div class="caption">
                        Anomalies
                    </div>
                    <div class="tools">
                        <div class="pull-right" ng-init="AnoIsExpanded=true" ng-click="AnoIsExpanded=!AnoIsExpanded">
                            <svg class="svgIcon " style="width:16px;height:16px;color:#B9BCC0;fill:grey" ng-show="!AnoIsExpanded" viewbox="0 0 32 32" title="expand header"><g><g><polygon points="24.158,16.274 22.385,14.5 15.939,20.824 9.615,14.5 7.842,16.274 16,24.432"></polygon></g><g><polygon points="24.158,9.342 22.385,7.568 15.939,13.892 9.615,7.568 7.842,9.342 16,17.5"></polygon></g></g></svg>
                            <svg class="svgIcon " style="width:16px;height:16px;color:#B9BCC0;fill:grey" ng-show="AnoIsExpanded" viewbox="0 0 32 32" title="collapse header"><g><g><polygon points="7.842,15.726 9.615,17.5 16.061,11.176 22.385,17.5 24.158,15.726 16,7.568"></polygon></g><g><polygon points="7.842,22.658 9.615,24.432 16.061,18.108 22.385,24.432 24.158,22.658 16,14.5"></polygon></g></g></svg>
                        </div>
                        <span class="pull-right" style="margin-right:15px;"><small>Number:</small>  <span class="text-info">  {{anomalies.length}}</span></span>
                    </div>
                </div>
                <img ng-show="!anomalies" src="assets/images/horizontal-loader.gif" class="img-responsive"/>

                <div class="portlet-body" style="padding:0!important;max-height:400px;overflow:auto" ng-show="AnoIsExpanded">
                  <table class="table table-striped table-hover" >
                      <tbody style="text-align:left;">
                          <tr ng-repeat="anomalie in anomalies | orderBy:'date'">
                              <td >
                                  <a href="/anomalie/{{anomalie._id}}">
                                    <img src="assets/images/anomaly.png" style="width:20px;height:20px;" alt="">
                                    <small class="dont-break-out"> {{anomalie.name}}</small>
                                  </a >
                              </td>
                              <td style="min-width:70px">
                                  <span class="pull-right text-info">
                                    <!-- <a href="task/{{anomalie.correctiveActions[0]._id}}" target="_blank"> -->
                                    <span class="btn btn-outline btn-xs" aria-hidden="false" ng-class="{'btn-info ':anomalie.correctiveActions[0].metrics[0].status === 'In Progress',' btn-default ':anomalie.correctiveActions[0].metrics[0].status === 'Not Started',' btn-danger ':anomalie.correctiveActions.length === 0,' btn-success':anomalie.correctiveActions[0].metrics[0].status === 'Finished'}">CA</span>
                                  <!-- </a> -->
                                  <!-- <a href="task/{{anomalie.preventiveActions[0]._id}}" target="_blank"> -->

                                    <span class="btn btn-outline btn-xs" aria-hidden="false" ng-class="{'btn-info ':anomalie.preventiveActions[0].metrics[0].status === 'In Progress',' btn-default ':anomalie.preventiveActions[0].metrics[0].status === 'Not Started',' btn-danger ':anomalie.preventiveActions.length === 0,' btn-success':anomalie.preventiveActions[0].metrics[0].status === 'Finished'}">PA</span>
                                  <!-- </a> -->
                                  </span>
                              </td>
                          </tr>
                      </tbody>
                  </table>
                </div>
                <div style="border-top:1px solide grey;width:100%">
                  &nbsp;
                </div>
            </div>
        </div>
    </div>
    <div class="col-lg-3 col-md-6 col-sm-12" ng-class="{'label-success':task.metrics[0].status ==='Finished','label-lightgrey':task.metrics[0].status =='Withdrawn'}" style="padding-bottom:20px;">
        <div class="pdcaCol" ng-class="{'label-success':task.metrics[0].status ==='Finished','label-lightgrey':task.metrics[0].status =='Withdrawn'}">
            CHECK
            <div class="pull-right" ng-if="task.metrics[0].status ==='Finished' || task.metrics[0].status =='Withdrawn'">
                <span class="label" >
                      {{task.metrics[0].status}}
                    </span>
            </div>
        </div>


        <!--Finished Tasks  -->
        <div class="portlet sale-summary" >
            <div class="portlet-title">
                <div class="caption" uib-tooltip-html="'(not reviewed)'" tooltip-placement="bottom">
                  Finished Tasks
                </div>
                <div class="tools">
                    <div class="pull-right" ng-init="FinishedTasksIsExpanded=true" ng-click="FinishedTasksIsExpanded=!FinishedTasksIsExpanded">
                        <svg class="svgIcon " style="width:16px;height:16px;color:#B9BCC0;fill:grey" ng-show="!FinishedTasksIsExpanded" viewbox="0 0 32 32" title="expand header"><g><g><polygon points="24.158,16.274 22.385,14.5 15.939,20.824 9.615,14.5 7.842,16.274 16,24.432"></polygon></g><g><polygon points="24.158,9.342 22.385,7.568 15.939,13.892 9.615,7.568 7.842,9.342 16,17.5"></polygon></g></g></svg>
                        <svg class="svgIcon " style="width:16px;height:16px;color:#B9BCC0;fill:grey" ng-show="FinishedTasksIsExpanded" viewbox="0 0 32 32" title="collapse header"><g><g><polygon points="7.842,15.726 9.615,17.5 16.061,11.176 22.385,17.5 24.158,15.726 16,7.568"></polygon></g><g><polygon points="7.842,22.658 9.615,24.432 16.061,18.108 22.385,24.432 24.158,22.658 16,14.5"></polygon></g></g></svg>
                    </div>
                    <i class="fa fa-hashtag" aria-hidden="true"></i><span class="text-info">  {{filteredFinishedTasks.length}}</span>&nbsp;&nbsp;
                    <i class="fa fa-clock-o" aria-hidden="true"></i><span class="text-info">  {{filteredFinishedTasksLoad}} </span><small>MD</small>

                </div>
            </div>
            <img ng-show="!filteredFinishedTasks" src="assets/images/horizontal-loader.gif" class="img-responsive"/>

            <div class="portlet-body" style="padding:0!important;height:400px;overflow:auto" ng-show="FinishedTasksIsExpanded">
                <table class="table table-striped table-hover">
                    <tbody style="text-align:left;">
                        <tr ng-repeat="task in filteredFinishedTasks | orderBy:'-metrics[0].endDate'">
                          <td style="text-align: center">
                            <img alt="" ng-src="{{task.actors[0].avatar}}" class="img-circle" style="width:30px;height:30px;" err-src="assets/images/avatars/avatar.png" uib-tooltip-html="'Name <br /> {{task.actors[0].name}}'" tooltip-placement="top"/>
                          </td>
                            <td>
                              <a href="/task/{{task._id}}">
                                <small class="dont-break-out"><span  ng-bind-html="task.taskSuffIcon"></span> {{task.name}}</small>

                              </a >
                            </td>
                            <td style="min-width:70px">
                                <span class="pull-right text-info">
                                  <small class="text-muted" >
                                    {{ (task.metrics[0].endDate | date:'MMM, dd') }}
                                  </small>
                                </span>
                            </td>
                        </tr>
                    </tbody>
                </table>

            </div>
            <div style="border-top:1px solide grey;width:100%">
              &nbsp;
            </div>
        </div>


        <!-- KPIs -->
        <div class="" id="KPI">
            <div class="portlet sale-summary" ng-if="dashboard._id">
                <div class="portlet-title">
                    <div class="caption">
                        KPIs
                    </div>
                    <div class="tools">
                        <div class="pull-right" ng-init="KPIIsExpanded=true" ng-click="KPIIsExpanded=!KPIIsExpanded">
                            <svg class="svgIcon " style="width:16px;height:16px;color:#B9BCC0;fill:grey" ng-show="!KPIIsExpanded" viewbox="0 0 32 32" title="expand header"><g><g><polygon points="24.158,16.274 22.385,14.5 15.939,20.824 9.615,14.5 7.842,16.274 16,24.432"></polygon></g><g><polygon points="24.158,9.342 22.385,7.568 15.939,13.892 9.615,7.568 7.842,9.342 16,17.5"></polygon></g></g></svg>
                            <svg class="svgIcon " style="width:16px;height:16px;color:#B9BCC0;fill:grey" ng-show="KPIIsExpanded" viewbox="0 0 32 32" title="collapse header"><g><g><polygon points="7.842,15.726 9.615,17.5 16.061,11.176 22.385,17.5 24.158,15.726 16,7.568"></polygon></g><g><polygon points="7.842,22.658 9.615,24.432 16.061,18.108 22.385,24.432 24.158,22.658 16,14.5"></polygon></g></g></svg>
                        </div>
                        <span class="pull-right" style="margin-right:15px;"><small>Number:</small>  <span class="text-info">  {{dashboard.kpis.length}}</span></span>
                    </div>
                </div>
                <div class="portlet-body" style="padding:0!important;max-height:400px;overflow:auto" ng-show="KPIIsExpanded">
                    <table class="table table-striped table-hover">
                        <tbody style="text-align:center;">
                            <tr ng-repeat="KPI in dashboard.kpis | orderBy:['constraint','name'] track by $index" on-finish-render uib-tooltip-html="'Contraint : {{KPI.constraint}}<br /> <br /> Description :  {{KPI.description}}  <br /> Suggestion :  {{KPI.suggestion}}'" tooltip-placement="left"  tooltip-class="tooltipkpi"  >
                                <td style="text-align:left;width:65%"><a href="/KPI/{{KPI.kpiId}}?type=dashboard&typeid={{dashboard._id}}&rangedate={{datediff}}">{{KPI.name}}</a></td>
                                <td style="text-align:left;width:35%;font-size:13px">
                                    <span ng-if="KPI.calcul[rangeDate] !== undefined && KPI.calcul[rangeDate] !== null" class="badge" ng-style="{'background-color':giveMeMyColor(KPI.calcul[rangeDate], KPI.category)}" style="height:15px;line-height:10px;width:15px;margin-right: 10px">&nbsp;&nbsp;</span> {{KPI.calcul[rangeDate]}}
                                    <span ng-if="KPI.category === 'Goal' && KPI.calcul[rangeDate] !== undefined && KPI.calcul[rangeDate] !== null"> %</span>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div style="border-top:1px solide grey;width:100%">
                  &nbsp;
                </div>
            </div>
        </div>
    </div>
    <div class="col-lg-3 col-md-6 col-sm-12" ng-class="{'label-success':task.metrics[0].status ==='Finished','label-lightgrey':task.metrics[0].status =='Withdrawn'}" style="padding-bottom:20px;">
        <div class="pdcaCol">
            ACT
        </div>
        <!-- Review -->
        <div class="portlet sale-summary" >
            <div class="portlet-title">
                <div class="caption">
                    Reviewed Tasks
                </div>
                <div class="tools">
                    <div class="pull-right" ng-init="ReviewedTasksIsExpanded=true" ng-click="ReviewedTasksIsExpanded=!ReviewedTasksIsExpanded">
                        <svg class="svgIcon " style="width:16px;height:16px;color:#B9BCC0;fill:grey" ng-show="!ReviewedTasksIsExpanded" viewbox="0 0 32 32" title="expand header"><g><g><polygon points="24.158,16.274 22.385,14.5 15.939,20.824 9.615,14.5 7.842,16.274 16,24.432"></polygon></g><g><polygon points="24.158,9.342 22.385,7.568 15.939,13.892 9.615,7.568 7.842,9.342 16,17.5"></polygon></g></g></svg>
                        <svg class="svgIcon " style="width:16px;height:16px;color:#B9BCC0;fill:grey" ng-show="ReviewedTasksIsExpanded" viewbox="0 0 32 32" title="collapse header"><g><g><polygon points="7.842,15.726 9.615,17.5 16.061,11.176 22.385,17.5 24.158,15.726 16,7.568"></polygon></g><g><polygon points="7.842,22.658 9.615,24.432 16.061,18.108 22.385,24.432 24.158,22.658 16,14.5"></polygon></g></g></svg>
                    </div>
                    <i class="fa fa-hashtag" aria-hidden="true"></i><span class="text-info">  {{filteredReviewedTasks.length}}</span>&nbsp;&nbsp;
                    <i class="fa fa-clock-o" aria-hidden="true"></i><span class="text-info">  {{filteredReviewedTasksLoad}} </span><small>MD</small>
                </div>
            </div>
            <img ng-show="!filteredReviewedTasks" src="assets/images/horizontal-loader.gif" class="img-responsive"/>

            <div class="portlet-body" style="padding:0!important;height:400px;overflow:auto" ng-show="ReviewedTasksIsExpanded">
                <table class="table table-striped table-hover">
                    <tbody style="text-align:left;">
                        <tr ng-repeat="task in filteredReviewedTasks | orderBy:'-metrics[0].endDate'">
                          <td style="text-align: center">
                            <img alt="" ng-src="{{task.actors[0].avatar}}" class="img-circle" style="width:30px;height:30px;" err-src="assets/images/avatars/avatar.png" uib-tooltip-html="'Name <br /> {{task.actors[0].name}}'" tooltip-placement="top"/>
                          </td>
                            <td>
                              <a href="/task/{{task._id}}">
                                <small class="dont-break-out"><span  ng-bind-html="task.taskSuffIcon"></span> {{task.name}}</small>

                              </a >
                            </td>
                            <td style="min-width:70px">
                                <span class="pull-right text-info">
                                  <small class="text-muted" >
                                    {{ (task.metrics[0].endDate | date:'MMM, dd') }}
                                  </small>
                                </span>
                            </td>
                        </tr>
                    </tbody>
                </table>

            </div>
            <div style="border-top:1px solide grey;width:100%">
              &nbsp;
            </div>
        </div>

        <!-- Review -->
        <div class="" id="Review">
            <div class="portlet sale-summary" ng-if="dashboard._id === 1">
                <div class="portlet-title">
                    <div class="caption">
                        Review
                    </div>
                    <div class="tools">
                        <div class="pull-right" ng-click="ReviewIsExpanded=!ReviewIsExpanded">
                            <svg class="svgIcon " style="width:16px;height:16px;color:#B9BCC0;fill:grey" ng-show="!ReviewIsExpanded" viewbox="0 0 32 32" title="expand header"><g><g><polygon points="24.158,16.274 22.385,14.5 15.939,20.824 9.615,14.5 7.842,16.274 16,24.432"></polygon></g><g><polygon points="24.158,9.342 22.385,7.568 15.939,13.892 9.615,7.568 7.842,9.342 16,17.5"></polygon></g></g></svg>
                            <svg class="svgIcon " style="width:16px;height:16px;color:#B9BCC0;fill:grey" ng-show="ReviewIsExpanded" viewbox="0 0 32 32" title="collapse header"><g><g><polygon points="7.842,15.726 9.615,17.5 16.061,11.176 22.385,17.5 24.158,15.726 16,7.568"></polygon></g><g><polygon points="7.842,22.658 9.615,24.432 16.061,18.108 22.385,24.432 24.158,22.658 16,14.5"></polygon></g></g></svg>
                        </div>
                        <span class="pull-right" style="margin-right:15px;"><small>Number:</small>  <span class="text-info">  {{task.reviews.length ||0}}</span></span>
                    </div>
                </div>
                <div class="portlet-body" style="padding:0!important;max-height:400px;overflow:auto" ng-show="ReviewIsExpanded">
                  <table class="table table-striped table-hover">
                      <tbody style="text-align:center;">
                          <tr >
                              <td style="text-align:left;">Task Review</td>
                              <td style="text-align:right;padding-right:25px;font-size:13px">
                                <div class="circularButtonView circularToggleButtonView-button circularButtonView--xsmall circularButtonView--onWhiteBackground circularButtonView--active">
                                    <span class="circularButtonView-label">
                                      <svg class="svgIcon " viewbox="0 0 32 32" title="checkmark">
                                        <polygon points="27.672,4.786 10.901,21.557 4.328,14.984 1.5,17.812 10.901,27.214 30.5,7.615 "></polygon>
                                      </svg>
                                    </span>
                                </div>
                              </td>
                          </tr>
                          <tr >
                              <td style="text-align:left;">Perimeter Review</td>
                              <td style="text-align:right;padding-right:25px;font-size:13px">
                                <div class="circularButtonView circularToggleButtonView-button circularButtonView--xsmall circularButtonView--onWhiteBackground circularButtonView--active">
                                    <span class="circularButtonView-label">
                                      <svg class="svgIcon " viewbox="0 0 32 32" title="checkmark">
                                        <polygon points="27.672,4.786 10.901,21.557 4.328,14.984 1.5,17.812 10.901,27.214 30.5,7.615 "></polygon>
                                      </svg>
                                    </span>
                                </div>
                              </td>
                          </tr>
                      </tbody>
                  </table>
                </div>
            </div>
        </div>
        <div class="" id="ActionPlans">
          <div class="portlet sale-summary" >
              <div class="portlet-title">
                  <div class="caption">
                      Action Plans
                  </div>
                  <div class="tools">
                      <div class="pull-right" ng-init="ActionPlanTasksIsExpanded=true" ng-click="ActionPlanTasksIsExpanded=!ActionPlanTasksIsExpanded">
                          <svg class="svgIcon " style="width:16px;height:16px;color:#B9BCC0;fill:grey" ng-show="!ActionPlanTasksIsExpanded" viewbox="0 0 32 32" title="expand header"><g><g><polygon points="24.158,16.274 22.385,14.5 15.939,20.824 9.615,14.5 7.842,16.274 16,24.432"></polygon></g><g><polygon points="24.158,9.342 22.385,7.568 15.939,13.892 9.615,7.568 7.842,9.342 16,17.5"></polygon></g></g></svg>
                          <svg class="svgIcon " style="width:16px;height:16px;color:#B9BCC0;fill:grey" ng-show="ActionPlanTasksIsExpanded" viewbox="0 0 32 32" title="collapse header"><g><g><polygon points="7.842,15.726 9.615,17.5 16.061,11.176 22.385,17.5 24.158,15.726 16,7.568"></polygon></g><g><polygon points="7.842,22.658 9.615,24.432 16.061,18.108 22.385,24.432 24.158,22.658 16,14.5"></polygon></g></g></svg>
                      </div>
                      <i class="fa fa-hashtag" aria-hidden="true"></i><span class="text-info">  {{filteredActionPlanTasks.length}}</span>&nbsp;&nbsp;
                      <i class="fa fa-clock-o" aria-hidden="true"></i><span class="text-info">  {{filteredActionPlanTasksLoad}} </span><small>MD</small>
                  </div>
              </div>
              <div class="portlet-body" style="padding:0!important;max-height:400px;overflow:auto" ng-show="ActionPlanTasksIsExpanded">
                  <table class="table table-striped table-hover">
                      <tbody style="text-align:left;">
                          <tr ng-repeat="task in filteredActionPlanTasks | orderBy:'-metrics[0].endDate'">
                            <td style="text-align: center">
                              <img alt="" ng-src="{{task.actors[0].avatar}}" class="img-circle" style="width:30px;height:30px;" err-src="assets/images/avatars/avatar.png" uib-tooltip-html="'Name <br /> {{task.actors[0].name}}'" tooltip-placement="top"/>
                            </td>
                              <td>
                                <a href="/task/{{task._id}}">
                                  <small class="dont-break-out"> {{task.name}}</small>

                                </a >
                              </td>
                              <td style="min-width:70px">
                                  <span class="pull-right text-info">
                                    <small class="text-muted" >
                                      {{ (task.metrics[0].endDate | date:'MMM, dd') }}
                                    </small>
                                  </span>
                              </td>
                          </tr>
                      </tbody>
                  </table>

              </div>
                <div class="portlet-body" style="margin-top:8px;margin-left:0;margin-right:0;padding-left:0;padding-right:0">
                  <table class="table table-striped table-hover" >
                      <tbody style="text-align:left;">
                          <tr style="height:40px;background:#eee;text-align:right">
                              <td >
                                  <a href="#" class="btn btn-outline btn-primary" ng-click="createNewTask('actionplan')">
                                    <i class="fa fa-plus"></i>
                                    <span class="dont-break-out"> Create an Action Plan</span>
                                  </a >
                              </td>
                          </tr>
                      </tbody>
                  </table>

                </div>
            </div>
        </div>
    </div>
</div>
</div>

<!-- *************** -->
<!-- SECOND PAGE     -->
<!-- *************** -->

<div ng-cloak ng-show="dashboardSlide==='History'" id="dashboard_history" class="row"  cg-busy="myPromise2">
    <h4 style="width:100%;text-align:center"> Understand <u style="font-weight:bold">past</u> metrics and performance of your perimeter</h4>
  <div class="col-md-12 col-sm-12  ">
    <!-- BEGIN OVERVIEW STATISTIC BARS-->
    <!-- BEGIN OVERVIEW STATISTIC BARS-->
      <div class="col-md-2 col-sm-12 align-center">
        Perimeter <small class="text-muted">(and SubPerimeters)</small>
        <hr style="margin:7px">
      </div>
      <div class="col-md-4 col-sm-12 align-center">
        Quantity Trends <small class="text-muted">(Metrics)</small>
        <hr style="margin:7px">
      </div>
      <div class="col-md-6 col-sm-12 align-center">
        <span ng-if="viewMode.blnPerf">
        Quality Trends <small class="text-muted"> (KPIs)</small>
        </span>
        <span ng-if="!viewMode.blnPerf">
        Contract  <small class="text-muted"> (UO)</small>
        </span>
        <div class="pull-right" ng-if="currentUser.role==='manager' || currentUser.role==='admin'" ng-click="viewMode.blnPerf = !viewMode.blnPerf">
  <button type="button" class="btn btn-toggle btn-toggle-text" data-toggle="button" aria-pressed="false" autocomplete="off" >
    <div class="handle"></div>
  </button>
</div>
        <hr style="margin:7px">
      </div>

  </div>

  <div class="col-md-12 col-sm-12 ">
    <!-- BEGIN OVERVIEW STATISTIC BARS-->
    <div class="row stats-overview-cont" >
      <div class="col-md-2 col-sm-12">
        <div class="stats-overview stat-block">
          <div class="details">
            <div class="title" style="height:61px">
                  <b> {{dashboard.name}}</b>
                  <br>
                  All Tasks Nb : <span style="color:#9467bd">{{alltasksNb}}</span>
                  <br>
                  All Workload : <span style="color:#9467bd">{{allmetricsNb}}</span>

            </div>
          </div>
        </div>
      </div>
      <div class="col-md-2 col-sm-12">
        <div class="stats-overview stat-block">
          <div class="details">
            <div class="title">
              <a href="#" ng-click="blnShowAllTasks=!blnShowAllTasks">
                <span style="font-weight:bold;color:#9467bd">{{tasksNb | number:0}}</span>
                Tasks</a>
            </div>
            <nvd3 options="optionsTasks" data="dataTasks" ng-if="dashboardSlide==='History'"></nvd3>
          </div>
        </div>
      </div>
        <div class="col-md-2 col-sm-12">
        <div class="stats-overview stat-block">
          <div class="details">
            <div class="title">
              <a href="#" ng-click="blnShowAllTasks=!blnShowAllTasks">
                <span style="font-weight:bold;color:#87CEEB">{{metricsNb | number:0}}</span>
                Men Days</a>
            </div>
            <nvd3 options="optionsLoad" data="dataMetrics" ng-if="dashboardSlide==='History'"></nvd3>
          </div>
        </div>
      </div>
      <div class="col-md-2 col-sm-12" ng-if="!viewMode.blnPerf">
        <div class="stats-overview stat-block">
          <div class="details">
            <div class="title">
              <a href="#" ng-click="blnShowAllTasks=!blnShowAllTasks">
                <span style="font-weight:bold;color:#87CEEB">{{dataUOMetricsNb | number:0}}</span>
                Men Days UO</a>
              </div>
              <nvd3 options="optionsUOLoad" data="dataUOMetrics" ng-if="dashboardSlide==='History'"></nvd3>
            </div>
          </div>
        </div>
        <div class="col-md-2 col-sm-12" ng-if="!viewMode.blnPerf">
          <div class="stats-overview stat-block">
            <div class="details">
              <div class="title">
                <a href="#" ng-click="blnShowAllTasks=!blnShowAllTasks">
                  <span style="font-weight:bold;color:#87CEEB">{{dataUODiffMetricsNb | number:0}}</span>
                  Diff UO</a>
                </div>
                <nvd3 options="optionsUODiff" data="dataUODiffMetrics" ng-if="dashboardSlide==='History'"></nvd3>
              </div>
            </div>
          </div>
          <div class="col-md-2 col-sm-12" ng-if="!viewMode.blnPerf">
            <div class="stats-overview stat-block">
              <div class="details">
                <div class="title">
                  <a href="#" ng-click="blnShowAllTasks=!blnShowAllTasks">
                    <span style="font-weight:bold;color:#87CEEB">{{dataUOPerfMetricsNb | number:0}}</span>
                    Perf UO</a>
                  </div>
                  <nvd3 options="optionsCosts" data="dataUOPerfMetrics" ng-if="dashboardSlide==='History'"></nvd3>
                </div>
              </div>
            </div>
      <div class="col-md-2 col-sm-12" ng-if="viewMode.blnPerf">
      <div class="stats-overview stat-block">
        <div class="details">
          <div class="title">
            <a href="#">
              <span style="font-weight:bold;color:#87CEEB">{{qualityNb | number:0}}%</span>
              Delivery</a>
          </div>
          <nvd3 options="optionsCosts" data="dataQuality" ng-if="dashboardSlide==='History'"></nvd3>
        </div>
      </div>
    </div>
    <div class="col-md-2 col-sm-12" ng-if="viewMode.blnPerf">
    <div class="stats-overview stat-block">
      <div class="details">
        <div class="title">
          <a href="#">
            <span style="font-weight:bold;color:#87CEEB">{{costNb | number:0}}%</span>
            Costs</a>
        </div>
        <nvd3 options="optionsCosts" data="dataCost" ng-if="dashboardSlide==='History'"></nvd3>
      </div>
    </div>
  </div>
  <div class="col-md-2 col-sm-12" ng-if="viewMode.blnPerf">
  <div class="stats-overview stat-block">
    <div class="details">
      <div class="title">
        <a href="#">
          <span style="font-weight:bold;color:#87CEEB">{{timeNb | number:0}}%</span>
          Time</a>
      </div>
      <nvd3 options="optionsCosts" data="dataTime" ng-if="dashboardSlide==='History'"></nvd3>
    </div>
  </div>
</div>
    </div>
    <!-- END OVERVIEW STATISTIC BARS-->


    <!--  DEBUT LISTE TACHES
    ******************************-->
    <div class="row" ng-if="blnShowAllTasks===true">
    <div class="col-md-11 portlet-body" style="margin-left:35px;margin-top:15px">
          <table class="table table-striped table-bordered table-hover" id="sample_4">
            <thead>
              <tr>
                <th class="hidden-xs">
                  <a style="text-decoration: none" href="#" ng-click="orderByField='actors[0].name'; reverseSort = !reverseSort">
                    Owner <span ng-show="orderByField === 'actors[0].name'"><span ng-show="!reverseSort"> &nbsp;&nbsp;&nbsp; <i class="fa fa-sort-asc"></i></span><span ng-show="reverseSort">&nbsp;&nbsp;&nbsp; <i class="fa fa-sort-desc"></i></span></span>
                  </a>
                </th>
                <th style="min-width:300px;max-width:500px;">
                  <a style="text-decoration: none" href="#" ng-click="orderByField='Name'; reverseSort = !reverseSort">
                    Name <span ng-show="orderByField === 'Name'"><span ng-show="!reverseSort"> &nbsp;&nbsp;&nbsp; <i class="fa fa-sort-asc"></i></span><span ng-show="reverseSort">&nbsp;&nbsp;&nbsp; <i class="fa fa-sort-desc"></i></span></span>
                  </a>
                </th>
                <th style="width:250px;">
                  <a style="text-decoration: none" href="#" ng-click="orderByField='activity'; reverseSort = !reverseSort">
                   Process <span ng-show="orderByField === 'activity'"><span ng-show="!reverseSort"> &nbsp;&nbsp;&nbsp; <i class="fa fa-sort-asc"></i></span><span ng-show="reverseSort">&nbsp;&nbsp;&nbsp; <i class="fa fa-sort-desc"></i></span></span>
                  </a>
                </th>
                <th style="width:250px;">
                  <a style="text-decoration: none" href="#" ng-click="orderByField='context'; reverseSort = !reverseSort">
                    Contexte <span ng-show="orderByField === 'context'"><span ng-show="!reverseSort"> &nbsp;&nbsp;&nbsp; <i class="fa fa-sort-asc"></i></span><span ng-show="reverseSort">&nbsp;&nbsp;&nbsp; <i class="fa fa-sort-desc"></i></span></span>
                  </a>
                </th>
                <th style="max-width:50px;width:auto;min-width:20px;">
                  <a style="text-decoration: none" href="#" ng-click="orderByField='metrics[task.metrics.length - 1].startDate'; reverseSort = !reverseSort">
                    Start <span ng-show="orderByField === 'metrics[task.metrics.length - 1].startDate'"><span ng-show="!reverseSort"> &nbsp;&nbsp;&nbsp; <i class="fa fa-sort-asc"></i></span><span ng-show="reverseSort">&nbsp;&nbsp;&nbsp; <i class="fa fa-sort-desc"></i></span></span>
                  </a>
                </th>
                <th style="max-width:50px;width:auto;width:150px;">
                  <a style="text-decoration: none" href="#" ng-click="orderByField='metrics[task.metrics.length - 1].load'; reverseSort = !reverseSort">
                    Load <span ng-show="orderByField === 'metrics[task.metrics.length - 1].load'"><span ng-show="!reverseSort"> &nbsp;&nbsp;&nbsp; <i class="fa fa-sort-asc"></i></span><span ng-show="reverseSort">&nbsp;&nbsp;&nbsp; <i class="fa fa-sort-desc"></i></span></span>
                  </a>
                </th>
                <th style="max-width:50px;width:auto;min-width:20px;">
                  <a style="text-decoration: none" href="#" ng-click="orderByField='metrics[task.metrics.length - 1].endDate'; reverseSort = !reverseSort">
                    End <span ng-show="orderByField === 'metrics[task.metrics.length - 1].endDate'"><span ng-show="!reverseSort"> &nbsp;&nbsp;&nbsp; <i class="fa fa-sort-asc"></i></span><span ng-show="reverseSort">&nbsp;&nbsp;&nbsp; <i class="fa fa-sort-desc"></i></span></span>
                  </a>
                </th>
              </tr>
            </thead>
            <tbody infinite-scroll="getMoreData()" infinite-scroll-distance="3">
              <tr ng-repeat="task in dashboard.tasks | orderBy:orderByField:reverseSort">
                <td style="text-align: left">
                  <div >
                  <!-- <div uib-tooltip-html="'Name : <b>{{task.actors[0].name}}</b>'" tooltip-placement="top"> -->
                    <img alt="" ng-src="{{ task.actors[0].avatar || 'assets/images/avatars/' + task.actors[0]._id + '.png'}} " class="img-circle" err-src="assets/images/avatars/avatar.png"/> <small class="text-muted">{{task.actors[0].name}}</small>
                  </div>
                </td>
                <td >
                  <a href="/task/{{task._id}}">
                    <div class="desc">{{task.name}}
                    </div>
                  </a>
                </td>
                <td >
                    <small class="dont-break-out" style="font-size:11px"> {{task.activity}}</small>

                </td>
                <td >
                    <small class="dont-break-out" style="font-size:11px"> {{task.context}}</small>

                </td>
                <td class="hidden-xs">
                  {{task.metrics[task.metrics.length - 1].targetstartDate | date:'mediumDate'}}<br/>


                  <span class="label label-sm label-lightinfo" ng-if="task.metrics[task.metrics.length - 1].startDate > task.metrics[task.metrics.length - 1].targetstartDate " >&nbsp;&nbsp;{{task.metrics[task.metrics.length - 1].startDate | date:'mediumDate'}}</span>
                </td>
                <td class="hidden-xs">

                <span ng-if="task.metrics[task.metrics.length - 1].status ==='Not Started' "
                  class="label label-sm"
                  ng-class="{'label-info':task.metrics[task.metrics.length - 1].status ==='In Progress','label-success':task.metrics[task.metrics.length - 1].status ==='Finished','label-default':task.metrics[task.metrics.length - 1].status ==='Not Started','label-lightgrey':task.metrics[task.metrics.length - 1].status =='Withdrawn','label-warning':task.metrics[task.metrics.length - 1].startDate < today}">
                  {{task.metrics[task.metrics.length - 1].status}}
                </span>
                <span ng-if="task.metrics[task.metrics.length - 1].status !=='Not Started'"
                  class="label label-sm"
                  ng-class="{'label-info':task.metrics[task.metrics.length - 1].status ==='In Progress','label-success':task.metrics[task.metrics.length - 1].status ==='Finished','label-default':task.metrics[task.metrics.length - 1].status ==='Not Started','label-lightgrey':task.metrics[task.metrics.length - 1].status =='Withdrawn'}">
                  {{task.metrics[task.metrics.length - 1].status}}
                </span>
              <small class="text-muted " ng-if="task.metrics[task.metrics.length - 1].status ==='In Progress'"><i>&nbsp;&nbsp;{{task.metrics[task.metrics.length - 1].progress}}%</i></small>
              <br>
                  <span>{{task.metrics[task.metrics.length - 1].targetLoad}} </span>
                    <span  ng-if="task.metrics[task.metrics.length - 1].projectedWorkload > task.metrics[task.metrics.length - 1].targetLoad">
                      &gt;&gt; <span class="label label-sm label-danger "> {{task.metrics[task.metrics.length - 1].projectedWorkload}}</span>
                    </span>
                    <span  ng-if="task.metrics[task.metrics.length - 1].projectedWorkload < task.metrics[task.metrics.length - 1].targetLoad">
                      &gt;&gt; <span class="label label-sm label-lightwarning "> {{task.metrics[task.metrics.length - 1].projectedWorkload}}</span>
                    </span>
                </td>
                <td class="hidden-xs">
                  {{task.metrics[task.metrics.length - 1].targetEndDate | date:'mediumDate'}}<br/>

                  <span class="label label-sm label-danger"  ng-if="task.metrics[task.metrics.length - 1].endDate > task.metrics[task.metrics.length - 1].targetEndDate">&nbsp;&nbsp;{{task.metrics[task.metrics.length - 1].endDate | date:'mediumDate'}}</span>
                </td>
              </tr>
            </tbody>
          </table>
      </div>
    </div>

  </div>
  <div class="col-md-12 col-sm-12 ">
    <div class="label" ng-class="subs ==='Activity' ? 'label-primary':'label-default'" ng-click="showHistory('Activity')" ><span ng-if="subs ==='Activity'">{{subHierarchies.length}}</span> Sub Activities</div>
    <div class="label" ng-class="subs ==='Context' ? 'label-primary':'label-default'" ng-click="showHistory('Context')"><span ng-if="subs ==='Context'">{{subHierarchies.length}}</span> Sub Context</div>
    <small class="label label-default pull-right" style ="font-size:10px" ng-click="showEmptyRow=!showEmptyRow">Show all</small>
    <hr style="margin-top:5px">
    <!-- BEGIN OVERVIEW STATISTIC BARS-->
    <div class="row stats-overview-cont" ng-repeat="subHierarchy in subHierarchies"  ng-if="dataTasksSubNb[subHierarchy.root + subHierarchy.name]>0 || showEmptyRow">
      <!-- -->
      <div class="col-md-2 col-sm-12">
        <div class="stats-overview stat-block">
          <div class="details">
            <div class="title" style="height:61px">
              <small class="text-muted" style="font-size:10px">{{subHierarchy.root}}</small><b ng-class="{'text-danger':!subHierarchy.abs,'text-success':subHierarchy.abs}">
              {{subHierarchy.name}}
              </b>
              <br>
            <small class="label label-primary"> {{(dataMetricsSubNb[subHierarchy.root + subHierarchy.name]/metricsNb *100)| number:0}}%</small>
            <small ng-if="subHierarchy.code" class="label label-default" style="color:#000000"> {{subHierarchy.code}} </small>
            </div>
          </div>
        </div>
      </div>
      <div class="col-md-2 col-sm-12">
        <div class="stats-overview stat-block">
          <div class="details">
            <div class="title">
              <a href="#" ng-click="blnShowTasks[subHierarchy.root + subHierarchy.name]=!blnShowTasks[subHierarchy.root + subHierarchy.name]">
                <span style="font-weight:bold;color:#9467bd">{{dataTasksSubNb[subHierarchy.root + subHierarchy.name]| number:0}}</span>
                Tasks</a>
            </div>
            <nvd3 options="optionsTasks" data="dataTasksSub[subHierarchy.root + subHierarchy.name]" ng-if="dashboardSlide==='History'"></nvd3>
          </div>
        </div>
      </div>
        <div class="col-md-2 col-sm-12">
        <div class="stats-overview stat-block">
          <div class="details">
            <div class="title">
              <a href="#" ng-click="blnShowTasks[subHierarchy.root + subHierarchy.name]=!blnShowTasks[subHierarchy.root + subHierarchy.name]">
                <span style="font-weight:bold;color:#87CEEB">{{dataMetricsSubNb[subHierarchy.root + subHierarchy.name]| number:0}}</span>
                Men Days</a>
            </div>
            <nvd3 options="optionsLoad" data="dataMetricsSub[subHierarchy.root + subHierarchy.name]" ng-if="dashboardSlide==='History'"></nvd3>
          </div>
        </div>
      </div>
      <div class="col-md-2 col-sm-12" ng-if="!viewMode.blnPerf">
        <div class="stats-overview stat-block"  ng-if="dataUOMetricsSubNb[subHierarchy.root + subHierarchy.name]>0">
          <div class="details">
            <div class="title">
              <a href="#" ng-click="blnShowTasks[subHierarchy.root + subHierarchy.name]=!blnShowTasks[subHierarchy.root + subHierarchy.name]">
                <span style="font-weight:bold;color:#87CEEB">{{dataUOMetricsSubNb[subHierarchy.root + subHierarchy.name]| number:0}}</span>
                Men Days UO</a>  <small class="label label-default" style="color:#555555">{{subHierarchy.value}} MD</small>
              </div>
              <nvd3 options="optionsUOLoad" data="dataUOMetricsSub[subHierarchy.root + subHierarchy.name]" ng-if="dashboardSlide==='History'"></nvd3>
            </div>
          </div>
        </div>
        <div class="col-md-2 col-sm-12" ng-if="!viewMode.blnPerf">
          <div class="stats-overview stat-block"  ng-if="dataUOMetricsSubNb[subHierarchy.root + subHierarchy.name]>0">
            <div class="details">
              <div class="title">
                <a href="#" ng-click="blnShowTasks[subHierarchy.root + subHierarchy.name]=!blnShowTasks[subHierarchy.root + subHierarchy.name]">
                  <span style="font-weight:bold;color:#87CEEB">{{dataUODiffMetricsSubNb[subHierarchy.root + subHierarchy.name]| number:0}}</span>
                  Diff UO</a>
                </div>
                <nvd3 options="optionsUODiff" data="dataUODiffMetricsSub[subHierarchy.root + subHierarchy.name]" ng-if="dashboardSlide==='History'"></nvd3>
              </div>
            </div>
          </div>
          <div class="col-md-2 col-sm-12" ng-if="!viewMode.blnPerf">
            <div class="stats-overview stat-block"  ng-if="dataUOMetricsSubNb[subHierarchy.root + subHierarchy.name]>0">
              <div class="details">
                <div class="title">
                  <a href="#" ng-click="blnShowTasks[subHierarchy.root + subHierarchy.name]=!blnShowTasks[subHierarchy.root + subHierarchy.name]">
                    <span style="font-weight:bold;color:#87CEEB">{{dataUOPerfMetricsSubNb[subHierarchy.root + subHierarchy.name]| number:0}}</span>
                    Perf UO</a>
                  </div>
                  <nvd3 options="optionsCosts" data="dataUOPerfMetricsSub[subHierarchy.root + subHierarchy.name]" ng-if="dashboardSlide==='History'"></nvd3>
                </div>
              </div>
            </div>
      <div class="col-md-2 col-sm-12" ng-if="viewMode.blnPerf">
      <div class="stats-overview stat-block">
        <div class="details">
          <div class="title">
            <a href="#" ng-click="blnShowKpis[subHierarchy.root + subHierarchy.name]=!blnShowKpis[subHierarchy.root + subHierarchy.name]">
              <span style="font-weight:bold;color:#87CEEB">{{dataQualitySubNb[subHierarchy.root + subHierarchy.name] | number:0}}% </span>
              Delivery</a>
          </div>
          <nvd3 options="optionsCosts" data="dataQualitySub[subHierarchy.root + subHierarchy.name]" ng-if="dashboardSlide==='History'"></nvd3>
        </div>
      </div>
    </div>
    <div class="col-md-2 col-sm-12" ng-if="viewMode.blnPerf">
    <div class="stats-overview stat-block">
      <div class="details">
        <div class="title">
          <a href="#" ng-click="blnShowKpis[subHierarchy.root + subHierarchy.name]=!blnShowKpis[subHierarchy.root + subHierarchy.name]">
            <span style="font-weight:bold;color:#87CEEB">{{dataCostSubNb[subHierarchy.root + subHierarchy.name] | number:0}}% </span>
            Costs</a>
        </div>
        <nvd3 options="optionsCosts" data="dataCostSub[subHierarchy.root + subHierarchy.name]" ng-if="dashboardSlide==='History'"></nvd3>
      </div>
    </div>
  </div>
  <div class="col-md-2 col-sm-12" ng-if="viewMode.blnPerf">
  <div class="stats-overview stat-block">
    <div class="details">
      <div class="title">
        <a href="#" ng-click="blnShowKpis[subHierarchy.root + subHierarchy.name]=!blnShowKpis[subHierarchy.root + subHierarchy.name]">
          <span style="font-weight:bold;color:#87CEEB">{{dataTimeSubNb[subHierarchy.root + subHierarchy.name] | number:0}}% </span>
          Time</a>
      </div>
      <nvd3 options="optionsCosts" data="dataTimeSub[subHierarchy.root + subHierarchy.name]" ng-if="dashboardSlide==='History'"></nvd3>
    </div>
  </div>
</div>

<!--  DEBUT LISTE TACHES
******************************-->
<div class="row" ng-if="blnShowTasks[subHierarchy.root + subHierarchy.name]===true">
<div class="col-md-11 portlet-body" style="margin-left:35px;margin-top:15px">
      <table class="table table-striped table-bordered table-hover">
        <thead>
          <tr>
            <th class="hidden-xs">
              <a style="text-decoration: none" href="#" ng-click="orderByField='actors[0].name'; reverseSort = !reverseSort">
                Owner <span ng-show="orderByField === 'actors[0].name'"><span ng-show="!reverseSort"> &nbsp;&nbsp;&nbsp; <i class="fa fa-sort-asc"></i></span><span ng-show="reverseSort">&nbsp;&nbsp;&nbsp; <i class="fa fa-sort-desc"></i></span></span>
              </a>
            </th>
            <th style="min-width:300px;max-width:500px;">
              <a style="text-decoration: none" href="#" ng-click="orderByField='Name'; reverseSort = !reverseSort">
                Name <span ng-show="orderByField === 'Name'"><span ng-show="!reverseSort"> &nbsp;&nbsp;&nbsp; <i class="fa fa-sort-asc"></i></span><span ng-show="reverseSort">&nbsp;&nbsp;&nbsp; <i class="fa fa-sort-desc"></i></span></span>
              </a>
            </th>
            <th style="width:250px;">
              <a style="text-decoration: none" href="#" ng-click="orderByField='activity'; reverseSort = !reverseSort">
               Process <span ng-show="orderByField === 'activity'"><span ng-show="!reverseSort"> &nbsp;&nbsp;&nbsp; <i class="fa fa-sort-asc"></i></span><span ng-show="reverseSort">&nbsp;&nbsp;&nbsp; <i class="fa fa-sort-desc"></i></span></span>
              </a>
            </th>
            <th style="width:250px;">
              <a style="text-decoration: none" href="#" ng-click="orderByField='context'; reverseSort = !reverseSort">
                Contexte <span ng-show="orderByField === 'context'"><span ng-show="!reverseSort"> &nbsp;&nbsp;&nbsp; <i class="fa fa-sort-asc"></i></span><span ng-show="reverseSort">&nbsp;&nbsp;&nbsp; <i class="fa fa-sort-desc"></i></span></span>
              </a>
            </th>
            <th style="max-width:50px;width:auto;min-width:20px;">
              <a style="text-decoration: none" href="#" ng-click="orderByField='metrics[task.metrics.length - 1].startDate'; reverseSort = !reverseSort">
                Start <span ng-show="orderByField === 'metrics[task.metrics.length - 1].startDate'"><span ng-show="!reverseSort"> &nbsp;&nbsp;&nbsp; <i class="fa fa-sort-asc"></i></span><span ng-show="reverseSort">&nbsp;&nbsp;&nbsp; <i class="fa fa-sort-desc"></i></span></span>
              </a>
            </th>
            <th style="max-width:50px;width:auto;width:150px;">
              <a style="text-decoration: none" href="#" ng-click="orderByField='metrics[task.metrics.length - 1].load'; reverseSort = !reverseSort">
                Load <span ng-show="orderByField === 'metrics[task.metrics.length - 1].load'"><span ng-show="!reverseSort"> &nbsp;&nbsp;&nbsp; <i class="fa fa-sort-asc"></i></span><span ng-show="reverseSort">&nbsp;&nbsp;&nbsp; <i class="fa fa-sort-desc"></i></span></span>
              </a>
            </th>
            <th style="max-width:50px;width:auto;min-width:20px;">
              <a style="text-decoration: none" href="#" ng-click="orderByField='metrics[task.metrics.length - 1].endDate'; reverseSort = !reverseSort">
                End <span ng-show="orderByField === 'metrics[task.metrics.length - 1].endDate'"><span ng-show="!reverseSort"> &nbsp;&nbsp;&nbsp; <i class="fa fa-sort-asc"></i></span><span ng-show="reverseSort">&nbsp;&nbsp;&nbsp; <i class="fa fa-sort-desc"></i></span></span>
              </a>
            </th>
          </tr>
        </thead>
        <tbody infinite-scroll="getMoreData()" infinite-scroll-distance="3">
          <tr ng-repeat="task in subTasks[subHierarchy.root + subHierarchy.name] | orderBy:orderByField:reverseSort">
            <td style="text-align: left">
              <div >
              <!-- <div uib-tooltip-html="'Name : <b>{{task.actors[0].name}}</b>'" tooltip-placement="top"> -->
                <img alt="" ng-src="{{ task.actors[0].avatar || 'assets/images/avatars/' + task.actors[0]._id + '.png'}} " class="img-circle" err-src="assets/images/avatars/avatar.png"/> <small class="text-muted">{{task.actors[0].name}}</small>
              </div>
            </td>
            <td >
              <a href="/task/{{task._id}}" target="_blank">
                <div class="desc">{{task.name}}
                </div>
              </a>
            </td>
            <td >
                <small class="dont-break-out" style="font-size:11px"> {{task.activity}}</small>

            </td>
            <td >
                <small class="dont-break-out" style="font-size:11px"> {{task.context}}</small>

            </td>
            <td class="hidden-xs">
              {{task.metrics[task.metrics.length - 1].targetstartDate | date:'mediumDate'}}<br/>


              <span class="label label-sm label-lightinfo" ng-if="task.metrics[task.metrics.length - 1].startDate > task.metrics[task.metrics.length - 1].targetstartDate " >&nbsp;&nbsp;{{task.metrics[task.metrics.length - 1].startDate | date:'mediumDate'}}</span>
            </td>
            <td class="hidden-xs">

            <span ng-if="task.metrics[task.metrics.length - 1].status ==='Not Started' "
              class="label label-sm"
              ng-class="{'label-info':task.metrics[task.metrics.length - 1].status ==='In Progress','label-success':task.metrics[task.metrics.length - 1].status ==='Finished','label-default':task.metrics[task.metrics.length - 1].status ==='Not Started','label-lightgrey':task.metrics[task.metrics.length - 1].status =='Withdrawn','label-warning':task.metrics[task.metrics.length - 1].startDate < today}">
              {{task.metrics[task.metrics.length - 1].status}}
            </span>
            <span ng-if="task.metrics[task.metrics.length - 1].status !=='Not Started'"
              class="label label-sm"
              ng-class="{'label-info':task.metrics[task.metrics.length - 1].status ==='In Progress','label-success':task.metrics[task.metrics.length - 1].status ==='Finished','label-default':task.metrics[task.metrics.length - 1].status ==='Not Started','label-lightgrey':task.metrics[task.metrics.length - 1].status =='Withdrawn'}">
              {{task.metrics[task.metrics.length - 1].status}}
            </span>
          <small class="text-muted " ng-if="task.metrics[task.metrics.length - 1].status ==='In Progress'"><i>&nbsp;&nbsp;{{task.metrics[task.metrics.length - 1].progress}}%</i></small>
          <br>
              <span>{{task.metrics[task.metrics.length - 1].targetLoad}} </span>
                <span  ng-if="task.metrics[task.metrics.length - 1].projectedWorkload > task.metrics[task.metrics.length - 1].targetLoad">
                  &gt;&gt; <span class="label label-sm label-danger "> {{task.metrics[task.metrics.length - 1].projectedWorkload}}</span>
                </span>
                <span  ng-if="task.metrics[task.metrics.length - 1].projectedWorkload < task.metrics[task.metrics.length - 1].targetLoad">
                  &gt;&gt; <span class="label label-sm label-lightwarning "> {{task.metrics[task.metrics.length - 1].projectedWorkload}}</span>
                </span>
            </td>
            <td class="hidden-xs">
              {{task.metrics[task.metrics.length - 1].targetEndDate | date:'mediumDate'}}<br/>

              <span class="label label-sm label-danger"  ng-if="task.metrics[task.metrics.length - 1].endDate > task.metrics[task.metrics.length - 1].targetEndDate">&nbsp;&nbsp;{{task.metrics[task.metrics.length - 1].endDate | date:'mediumDate'}}</span>
            </td>
          </tr>
        </tbody>
      </table>
  </div>
</div>

<!--  DEBUT LISTE KPIS
******************************-->

<div class="row" ng-if="blnShowKpis[subHierarchy.root + subHierarchy.name]===true">
<div class="col-md-12">
  <hr>
  <div class="row" >
    <div class="col-md-6 col-sm-12">

  </div>


<div class="col-md-2 col-sm-12" style="border:1px grey dashed;padding:5px">
  <div class="">
<div class="stats-overview stat-block" ng-repeat="kpi in dashboard.kpis | filter:{constraint:'Quality'}">
  <div class="details">
    <div class="title">
      <a href="#">
        <span style="font-weight:bold;color:#87CEEB"></span>
        {{kpi.name}}</a>

    </div>
    <nvd3 options="optionsCosts" data="dataSubKPIs[subHierarchy.root + subHierarchy.name]['Quality'][kpi.name]" ng-if="dashboardSlide==='History'"></nvd3>
  </div>
</div>
</div>
</div>
<div class="col-md-2 col-sm-12" style="border:1px grey dashed;padding:5px">
<div class="stats-overview stat-block" ng-repeat="kpi in dashboard.kpis | filter:{constraint:'Cost'}">
  <div class="details">
    <div class="title">
      <a href="#">
        <span style="font-weight:bold;color:#87CEEB"></span>
        {{kpi.name}}</a>
    </div>
    <nvd3 options="optionsCosts" data="dataSubKPIs[subHierarchy.root + subHierarchy.name]['Cost'][kpi.name]" ng-if="dashboardSlide==='History'"></nvd3>
  </div>
</div>
</div>
<div class="col-md-2 col-sm-12" style="border:1px grey dashed;padding:5px">
<div class="stats-overview stat-block" ng-repeat="kpi in dashboard.kpis | filter:{constraint:'Time'}">
  <div class="details">
    <div class="title">
      <a href="#">
        <span style="font-weight:bold;color:#87CEEB"></span>
        {{kpi.name}}</a>
    </div>
    <nvd3 options="optionsCosts" data="dataSubKPIs[subHierarchy.root + subHierarchy.name]['Time'][kpi.name]" ng-if="dashboardSlide==='History'"></nvd3>
  </div>
</div>
</div>

</div>
<hr>
</div>

</div>

    </div>
    <!-- END OVERVIEW STATISTIC BARS-->
  </div>
  <!--end col-md-8-->
  <!-- <div class="col-md-2 col-sm-12 ">
    <div class="stats-overview stat-block">
        <div id="myChartQCT"></div>
  </div>
  </div> -->
</div>


<!-- *************** -->
<!-- THIRD PAGE     -->
<!-- *************** -->

<div ng-cloak ng-show="dashboardSlide==='Timeline'" id="dashboard_timeline" class="row"  cg-busy="myPromise3" >
  <vis-timeline ng-show="timelineData" data="timelineData" options="timelineOptions"></vis-timeline>
</div>

<!-- *************** -->
<!-- MENU DROIT      -->
<!-- *************** -->
<div pageslide ps-open="checked" ps-speed="1" ps-push="true" class="ng-isolate-scope ng-pageslide" style="z-index: 1000; position: fixed; overflow:auto;transition-duration: 1s; height: 100%; transition-property: top, bottom, left, right; width: 300px; top: 0px; bottom: 0px; right: -300px;background-color:#eee">
                        <div style="padding:20px;margin-top:20px;" id="demo-right">
                            <h3 style="width:100%;text-align:center">Actions on Dashboard</h3>
                            <a class="btn btn-primary" style="width:100%" ng-click="toggle()">Close</a>
                            <hr>

                            <div style="width:100%;  display: inline-block;" ng-click="createAnomaly()">
                              <div style="width:29%;height:70px;float:left">
                                <img src="assets/images/problem.jpg" style="width:60px;" alt="">
                              </div>
                              <div style="width:69%;height:70px;table-cell;   vertical-align: middle; float:left;padding-left:5px" >
                                <p> Report an <u style="font-weight:bold">anomaly</u> that affects your activity </p>
                              </div>
                            </div>
                            <hr>

                            <div style="width:100%;  display: inline-block;"   ng-click="showHistory()" ng-class="{'activeActionMenu':dashboardSlide === 'History'}">
                              <div style="width:29%;height:70px;float:left">
                                <img src="assets/images/history-icon.png" style="width:60px;" alt="">
                              </div>
                              <div style="width:69%;height:70px;table-cell;   vertical-align: middle; float:left;padding-left:5px" >
                                <p> Understand <u style="font-weight:bold">past</u> metrics and performance of your perimeter</p>
                              </div>
                            </div>
                            <hr>

                            <div style="width:100%;  display: inline-block;"   ng-click="showHome()" ng-class="{'activeActionMenu':dashboardSlide === 'Home'}">
                              <div style="width:29%;height:70px;float:left" >
                                <img src="assets/images/performance-icon.png" style="width:60px;" alt="">
                              </div>
                              <div style="width:69%;height:70px;table-cell;   vertical-align: middle; float:left;padding-left:5px" >
                                <p> Action <u style="font-weight:bold">present</u> tasks and performance of your perimeter</p>
                              </div>
                            </div>
                            <hr>

                            <div style="width:100%;  display: inline-block;"   ng-click="showReview()" ng-class="{'activeActionMenu':dashboardSlide === 'Review'}">
                              <div style="width:29%;height:70px;float:left">
                                <img src="assets/images/coming-soon.png" style="width:70px;z-index:99999" alt="">
                                <img src="assets/images/futur-icon.png" style="width:60px;z-index:99998;float:left;margin-top:-70px;" alt="">
                              </div>
                              <div style="width:69%;height:70px;table-cell;   vertical-align: middle; float:left;padding-left:5px" >
                                <p> Anticipate <u style="font-weight:bold">future</u> tasks and performance of your perimeter</p>
                              </div>
                            </div>
                            <hr>

                            <div style="width:100%;  display: inline-block;"   ng-click="showTimeline()" ng-class="{'activeActionMenu':dashboardSlide === 'Timeline'}">
                              <div style="width:29%;height:70px;float:left">
                                <img src="assets/images/timeline.png" style="width:60px;" alt="">
                              </div>
                              <div style="width:69%;height:70px;table-cell;   vertical-align: middle; float:left;padding-left:5px" >
                                <p> View task in a <u style="font-weight:bold">Timeline</u></p>
                              </div>
                            </div>
                            <hr>

<br><br>
                            <div style="width:100%;  display: inline-block;"   ng-click="refreshDashboard()">
                              <div style="width:29%;height:70px;float:left">
                                <img src="assets/images/refresh-icon.png" style="width:60px;" alt="">
                              </div>
                              <div style="width:69%;height:70px;table-cell;   vertical-align: middle; float:left;padding-left:5px">
                                <p>Resfresh will operate again all calculations</p>
                              </div>
                            </div>
                            <hr>
                                                        <div style="width:100%;  display: inline-block;"   ng-click="showConfig()">
                                                          <div style="width:29%;height:70px;float:left">
                                                            <img src="assets/images/settings.png" style="width:70px;" alt="">
                                                          </div>
                                                          <div style="width:69%;height:70px; display: table-cell;   vertical-align: middle; float:left;padding-left:5px">
                                                            <p>Show and/or modify dashboard informations and subscription</p>
                                                          </div>
                                                        </div>
                                                        <hr>




                        </div>
                    </div>
